<hrml>
  <head>
  
  <title>SKYNET v.1.2.1 Manual</title>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="css/style.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" type="text/javascript"></script>
  <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
  </head>
  <body>
  <div id="wrapper">    
  <div id="main">
    <div id="columnMenu">
      <h2 class="logo"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAaCAYAAAD1wA/qAAAALHRFWHRDcmVhdGlvbiBUaW1lAMWaciAxOSBrd2kgMjAxNyAwMjo1Njo0NSArMDEwMBachLcAAAAHdElNRQfhBBMAORXFuVVnAAAACXBIWXMAAAsSAAALEgHS3X78AAAABGdBTUEAALGPC/xhBQAAAx9JREFUeNrtl19IU1Ecx+/+Ovtjioj5oEEPPS0J6inaW4EPBjXooVgPJfbQg+0hmBAoY7FUamwPU/eyDWszaq5oC5kVW8m0Qool+rIYDPawQpq49sf97XfmOTW16Zlt3oK+8OVc7j1/fp97zu/ccxnmv7aWUCgslCqViq/X6xvQtUgkYjus8sTj8QqlRCJhgsHg3Wg06pHL5XXFz/56kUA7OjqYUCikzWPFYrHp3t7e+n8Chs/nF0qpVMqEw2FDfoOSyeR7pVLZhOpwuVy2w90aQiaTMUtLS2P5EkqlUr7BwcFDqC6Hw2E77N9DdHd3cyORiDW/jTKZzH2dTsd22OtF1ntPT49wZWXFvh0E6C24OZfLMQaDge3w10MoFIpaSOZJCohZcAOYAXPBd8xm8zFWIUiy9vf31yUSCTcFhBdcjyGQzfh+aHx8XMwKBEnSgYGBRkjeWQqIafABDMABP9jwPGy324+zAqPVag9C0n6ggHgN3l+0nB6WqPcNYE7u6kyMjIy0ZbPZBQoItOT2YQge+PFWlWEDWB4dHZVUFYIk9tDQ0GEY8zMFxCvwXgwhAD+haIP03WQynakKBEnsvr6+I5DYAYpgXoD3YIga8DNKCKKk1Wo9W1EIspzUavXR1dXVEEUQLnAthhCBn5cJQZSamJg4X1EYjUZzIp1Of6UYfBIHz+AZce0QgijrdDovVgRieHj4FCR2hGJQ9OZrMATKjZd/CPFTU1NTVzeukLJkNBpPQz9RirEcYCGGQFutu1IQRB6P59qOYCwWSye0T1CM8TS/tishCPTRe1NpCKKZmZkbZcHYbLYL0C5N0be9CAKdobzVgiCam5tTkDg3/dMU0zkcjktQP0fRpw3MxxCN4HfVhiDy+Xy3NsEUU7lcriuUfT3Kr32pEUQTelG7BUG0uLh4u7W1tRC3QCD4NStut/s6ZR/orMTFEM3gj7sNQeT3+++1t7evAbS0tDBer/cmZVt0auVgiDbwJ7YgiAKBgK6rq0vImZ+fPycWi1XAhP5XMyXyHx20voA7wTF8Tw2+DF4uf2OvmFBeCOLx+NgP1c7Cc+35//8AAAAASUVORK5CYII=
"/> SKYNET</h2> 
      v.1.2.1 Manual
      (c) 2017 Marcin Szczyglinski<br/>Check for newest versions here: <a href="https://github.com/szczyglis-dev/php-skynet-remote-framework" target="_blank" title="https://github.com/szczyglis-dev/php-skynet-remote-framework">https://github.com/szczyglis-dev/php-skynet-remote-framework</a>
      <br/>Project website: <a href="https://skynetframework.blogspot.com" target="_blank" title="https://skynetframework.blogspot.com">https://skynetframework.blogspot.com</a>
      <br/>FB: <a href="https://www.facebook.com/Skynet-Framework-441383486200242" target="_blank" title="https://www.facebook.com/Skynet-Framework-441383486200242">Skynet-Framework-441383486200242</a><br/>
      <ol class="topics"><li><a href="#1_What_is_Skynet?">What is Skynet?</a></li><li><a href="#2_Getting_started">Getting started</a></li><ol><li><a href="#2_1_Getting_Skynet_from_GitHUB">Getting Skynet from GitHUB</a></li><li><a href="#2_2_Requirements">Requirements</a></li><li><a href="#2_3_Skynet_files_structure">Skynet files structure</a></li><li><a href="#2_4_How_Skynet_works?">How Skynet works?</a></li><li><a href="#2_5_First_launch">First launch</a></li></ol><li><a href="#3_Controlling_Skynet">Controlling Skynet</a></li><ol><li><a href="#3_1_Control_Panel_overview">Control Panel overview</a></li><li><a href="#3_2_Connection_Modes">Connection Modes</a></li></ol><li><a href="#4_Request_and_Response">Request and Response</a></li><ol><li><a href="#4_1_Request">Request</a></li><li><a href="#4_2_Response">Response</a></li></ol><li><a href="#5_Features">Features</a></li><ol><li><a href="#5_1_Send/receive_parameters">Send/receive parameters</a></li><li><a href="#5_2_Send/receive_commands">Send/receive commands</a></li><li><a href="#5_3_Self-updating">Self-updating</a></li><li><a href="#5_4_Self-cloning">Self-cloning</a></li><li><a href="#5_5_Sending_emails">Sending emails</a></li><li><a href="#5_6_Logging_events">Logging events</a></li><li><a href="#5_7_Broadcasting">Broadcasting</a></li><li><a href="#5_8_Sleep_and_Wakeup">Sleep and Wakeup</a></li><li><a href="#5_9_File_transfer">File transfer</a></li><li><a href="#5_10_Remote_system_shell_execution">Remote system shell execution</a></li><li><a href="#5_11_Remote_PHP_code_execution">Remote PHP code execution</a></li><li><a href="#5_12_Registry">Registry</a></li><li><a href="#5_13_Echo/Ping">Echo/Ping</a></li><li><a href="#5_14_SkynetPeer">SkynetPeer</a></li><li><a href="#5_15_SkynetMonitor">SkynetMonitor</a></li><li><a href="#5_16_Debugger">Debugger</a></li><li><a href="#5_17_SkynetClient">SkynetClient</a></li><li><a href="#5_18_Remote_Destroy">Remote Destroy</a></li></ol><li><a href="#6_Event_Listeners">Event Listeners</a></li><ol><li><a href="#6_1_Event:_onConnect">Event: onConnect</a></li><li><a href="#6_2_Event:_onRequest">Event: onRequest</a></li><li><a href="#6_3_Event:_onResponse">Event: onResponse</a></li><li><a href="#6_4_Event:_onEcho">Event: onEcho</a></li><li><a href="#6_5_Event:_onBroadcast">Event: onBroadcast</a></li><li><a href="#6_6_Event:_onConsole">Event: onConsole</a></li><li><a href="#6_7_Event:_onCli">Event: onCli</a></li><li><a href="#6_8_registerCommands">registerCommands</a></li><li><a href="#6_9_registerDatabase">registerDatabase</a></li></ol><li><a href="#7_How_to_create_own_Event_Listener?">How to create own Event Listener?</a></li><ol><li><a href="#7_1_Step_by_step">Step by step</a></li><li><a href="#7_2_API_Methods">API Methods</a></li></ol><li><a href="#8_Console">Console</a></li><ol><li><a href="#8_1_Syntax">Syntax</a></li><li><a href="#8_2_Commands_list">Commands list</a></li></ol><li><a href="#9_Compiling_Skynet_sources_into_standalone">Compiling Skynet sources into standalone</a></li><li><a href="#10_Extending_&_customizing">Extending & customizing</a></li><ol><li><a href="#10_1_Custom_Data_Encryption">Custom Data Encryption</a></li><li><a href="#10_2_Custom_Connection_Classes">Custom Connection Classes</a></li><li><a href="#10_3_Custom_Commands_Shortcuts">Custom Commands Shortcuts</a></li><li><a href="#10_4_Custom_Themes">Custom Themes</a></li></ol><li><a href="#11_Configuration">Configuration</a></li><li><a href="#12_CLI_mode">CLI mode</a></li><li><a href="#13_API_Documentation">API Documentation</a></li><li><a href="#14_Updating_Skynet">Updating Skynet</a></li><li><a href="#15_Contact_and_donate">Contact and donate</a></li></ol>Donate Skynet with:<br>BTC: <b>1LK9tDPBuBFXCKUThFWXNvdcdJ4gzx1Diz</b><br/>PayPal: <a target="_blank" href="https://www.paypal.me/szczyglinski"><b>https://www.paypal.me/szczyglinski</b></a><br>Version 1.2.1 build 2017.05.01
    </div>
     
    <div id="columnMain"><a name="1_What_is_Skynet?"></a><h1>1. What is Skynet?</h1><b>Skynet Framework is powerful, easy to use GNU/GPL licensed remote control package and cluster-based network connections builder written in PHP. <br />With Skynet you can create different instances of Skynet (called &quot;clusters&quot;) and place them on different servers and then connects with them and sending data between them.</b><br /><br />Skynet clusters works on request-response architecture as peer-to-peer clusters. They can connects between itselfs, requesting data, responds for them and more. Skynet have self-replication and self-update mechanisms, so you can clone or update your clusters even by remote easy access. Event-listener architecture implemented in Skynet allows you to create your own Event Listeners with easy to use API and allow you to expand Skynet's capabilities according to your needs. Skynet can operate in two modes - as PHP script administrated by browser and in PHP CLI. Thanks to both of these features Skynet offers console interface for quick and easy commands sending and parameters to other clusters. Skynet clusters work on dynamically created databases based on information from other clusters, requests and responses. Framework also have powerful logging system works on .txt files and database. Skynet is ONLY ONE FILE compiled from source classes (compiler is included). This feature allows you to operate Skynet easily using a single file from any location.<br /><br /><img src="img/skynet.png"><br /><br /><b>NOTE: Skynet can be some of kind C&amp;C service and can offers powerful possibilites with this. Please do not use Skynet for illegal purposes.</b><br /><br /><h2> Most important features of Skynet: </h2><br /><br />- Peer to peer clusters architecture<br />- Requesting and responding data via internal connections based on easy to use parameters<br />- Self updating registry about other clusters<br />- Broadcast mode (clusters to clusters | many-to-many peer-to-peer connections)<br />- Event Listeners based, easy to extend architecture of API<br />- It is only one file whitch is compiling from sources (you can extends Skynet by your own methods and compile all into single file)<br />- Powerful event log system<br />- Build-in console <br />- Works in two modes: browser and CLI<br />- Easy to integration with tools like CRON<br />- Remote code execution<br />- Remote shell access<br />- Remote files transfers<br />- Administration panel via browser<br />- PDO multiple database engines support<br />- Self-update engine (even via remote)<br />- Self-clone engine (even via remote)<br />- Easy to extends and customization<br />- Factory based connections adapters (you can implements you own connection methods, CURL is included)<br />- Factory based data encryption (you can implements you own algorithms, openSSL and Mcrypt are included)<br />- Factory based event and logger listeners (you can create your own listeners and data loggers)<br />- Sending responses via email engine included<br />- Sleep and wakeup clusters commands included<br />- Debugger included<br />- Full API documentation in PHPDOC<br />- It's all in one<br /><br /><b>Skynet Framework is under GNU/GPL license, so it's absolutely free to use but if you like it and think that Skynet is helpful to you - you can donate to the project with BTC.<br />Ok, so let's start with Skynet.</b><a name="2_Getting_started"></a><h1>2. Getting started</h1>Skynet Framework actual builds are hosted on GitHub. All you need to do is to download or clone repository and put it on your server.<br />It is preferred to start testing (if you using it at first time) on localhost server. After download and unpack archive or clone repository you will se some files and directories.<a name="2_1_Getting_Skynet_from_GitHUB"></a><h1>2.1. Getting Skynet from GitHUB</h1>Get Skynet from GitHub here: <a href="https://github.com/szczyglis-dev/php-skynet-remote-framework">https://github.com/szczyglis-dev/php-skynet-remote-framework</a><br />You can download or clone repository. Remember that Skynet is still in development, so check sometimes for newest versions.<br /><a name="2_2_Requirements"></a><h1>2.2. Requirements</h1>Skynet Framework requires these components to launch:<br /><br />- Webserver with PHP 5.5+ interpreter<br />- PDO extension (for databases connections) <br />- CURL extension (for CURL connections)<br />- browser with Javascript enabled for ajax-requests in Control Panel<br /><br />Skynet works on PHP5 and PHP7.<a name="2_3_Skynet_files_structure"></a><h1>2.3. Skynet files structure</h1>After you download and unpack (or clone) repository from GitHub then you should see files structure of Skynet:<br /><br />- <b>_compiled/</b> - compiled standalone versions will be placed here by default<br />- <b>_download/</b> - folder for downloaded files<br />- <b>logs/</b> - log files<br />- <b>manual/</b> - manual and API documentation<br />- <b>src/</b> - Skynet core, source classes<br />- <b>skynet_dev.php</b> - Non-compiled Skynet cluster (works on classes from <i>/src</i> directory via autoloader)<br />- <b>skynet_client.php</b> - Example of Skynet Client (intergration with other applications)<br />- <b>skynet.php</b> - Compiled Skynet cluster (all classes are compiled into single standalone file)<br />- <b>compiler.php</b> - Comilater script whitch compiling sources from <i>/src</i> folder into single standalone file<br />- <b>keygen.php</b> - Skynet Key ID generator<br />- <b>pwdgen.php</b> - Password hash to Skynet Panel generator<br />- <b>README.MD</b> - Readme file<br />- <b>CHANGELOG.txt</b> - Changelog<br />- <b>TODO.txt</b> - TO DO LIST in next versions<br />- <b>LICENSE.txt</b> - License<br />- <b>VERSION</b> - version info<br /><br />As you see you have two versions of Skynet cluster by default: <br /><br />- <b>skynet_dev.php</b> - version with autoloader works on classes from <i>src/</i> directory. You can use this version for development and tests<br />- <b>skynet.php</b> - compiled version with all classes from <i>src/</i> directory included itself. This is the &quot;production version&quot; - one single file to put on server after compile from <i>src/</i><br /><br />You can work on this two versions (when you launch both you will see that these two works exacly the same at now), but the idea od Skynet clusters is to operate on standalone compiled versions called here &quot;clusters&quot;.<br /><br />You will see also:<br /><br />- <b>skynet_client.php</b> - Client for Skynet connections. This is a simple example shows how to integrate Skynet with other applications.<a name="2_4_How_Skynet_works?"></a><h1>2.4. How Skynet works?</h1>An &quot;idea&quot; od Skynet is peer-to-peer based network communication between standalone clusters. You can see one of that created clusters in downloaded repository - it's called <i>skynet.php</i>.<br />You can create many clusters like that and then connects them with theirselfs. At the beginning you can simple copy <i>skynet.php</i> to another file, e.g. <i>skynet2.php</i> - if you do this you will have two Skynet clusters. <br />At next,  you can create more, e.g. <i>skynet3.php</i>, <i>skynet4.php</i>, etc. Finally you can put them on different servers if you want. All of there standalone clusters will build your network.<br /><br />At first launch of every cluster, Skynet will build database (SQLite is default and is recomennded). Every cluster creates their own database file named <i>.CLUSTER_NAME.db</i> (if SQLite is used). Of course you can use antother database engine (e.g. MySQL) and then Skynet will work on database like that, but SQLite is preferred. This is the idea: one cluster + one database file. From now, Skynet will store data about another clusters in their own database. This clusters list will be at next sended to another registered clusters so clusters knowed by one cluster will be shared with another cluster and added to their database. Every cluster will know about other clusters, that's the idea of this network. <br /><br />When at least one another cluster is knowed by your cluster you are allowed to share data and commands between them. Sending data between clusters is based on request-response architecture: one cluster sends request to another, and the another creates response from request then returns it to requesting one. With more that one cluster those requests and responses can be sending over whole network. Skynet resends information about knowed (registered) clusters to anothers when connects to them, so if you have 3 clusters, e.g. <i>skynet1.php</i>, <i>skynet2.php</i>, <i>skynet3.php</i> you need to connect them each other at first. How to do this? When you connect first cluster with second cluster at first time the second cluster will get and store address of first cluster in their database and the first cluster will store address of second cluster. At now, if you connect second cluster with cluster number three, the cluster numer three will get (and store) address of second cluster... and the first cluster. It's not the end, becose after that, cluster number three will connect with first cluster and sends them their address. At now, every clusters will &quot;see&quot; each other. If you then add another - four cluster and connect to it from cluster one - all of clusters will receive information about new cluster (becose cluster one will inform them).<br /><br />When Skynet knows about another clusters then starts broadcasting to all of them and allows to sending them requests (addressed to specified clusters, or adressed to whole network) and receiving responses from them. Every cluster is a sender and responder at once, so communication is in two-sides. Every request can have prepared parameters and commands specified by cluster or by user (and other cluster can responds for them with defined action).<a name="2_5_First_launch"></a><h1>2.5. First launch</h1>If you have unpacked repository from GitHub put all of files from it on your localhost (or other) server, e.g. <i>localhost/skynet/</i> and then launch in your browser:<br /><br /><pre class="prettyprint linenums">http://localhost/skynet/skynet_dev.php</pre><br />(non-compiled developer version)<br /><br />or<br /><br /><pre class="prettyprint linenums">http://localhost/skynet/skynet.php</pre><br />(compiled version)<br /><br />At now you will see the same on both of them - Skynet Control Panel:<br /><br /><img src="img/skynet.png"><br /><br />This panel displays informations about Skynet status and connections to another clusters. This panel also allows you to easy browse stored in database connections logs.<br />As you see, Skynet is not connected to any cluster and shows you 2 warnings - about empty password and empty <i>SkynetKeyID</i>. By default, after you download Skynet these two fields are set to start values - you will need to configure them itself. We will do this at the end.<br /><br />At first, let's try to connect clusters included in Skynet package.<br /><br />In console at the bottom of window of Skynet Control Panel type:<br /><br /><pre class="prettyprint linenums">@connect &quot;CLUSTER_ADDRESS&quot;;</pre><br />where <i>CLUSTER_ADDRESS</i> will be second cluster (<i>http://localhost/skynet/skynet.php</i> if you're in <i>/skynet_dev.php</i> and <i>http://localhost/skynet/skynet_dev.php</i> if you're in <i>/skynet.php</i>)<br />At next, click on &quot;Send request&quot; button.<br /><br />You should see information about connection with second cluster and the second cluster address should be stored into database.<br />Good. Now you have two working clusters. Let's try to create different clusters, e.g. by copying <i>skynet.php</i> into <i>skynet2.php</i>, etc. and try to connect with them.<br /><br />At the end, let's try to generate <i>SkynetKey ID</i> - this is the unique identifier of your clusters network. All of your clusters must have SAME KEY ID to allow connections between them. For security reasons Skynet cluster is checking this key in every connection. If requested key not match to cluster key then response is not generated.<br /><br />To generate your Key, launch key generator included in package:<br /><br /><pre class="prettyprint linenums">http://localhost/skynet/keygen.php</pre><br />This keygen generates randomly key in every launch. When you generate your key, place it into your Skynet config file:<br /><br /><pre class="prettyprint linenums">/src/SkynetUser/SkynetConfig.php</pre><br />and in:<br /><br /><pre class="prettyprint linenums">/skynet.php</pre><br />if you launched compiled version (remember that after compiling all configuration data from <i>/src</i> are includes into standalone file)<br /><br />Put <i>KEY ID</i> into:<br /><br /><pre class="prettyprint linenums">const KEY_ID</pre><br />(default here is: 1234567890, replace it with your Key)<br /><br />Now, let's go to admin password hash generator. This password is using for accessing to your Skynet Control Panel. By default, this password is not set, so you must create one.<br />Skynet needs hash of the password, not the plain text of it. To generate password hash go to:<br /><br /><pre class="prettyprint linenums">http://localhost/skynet/pwdgen.php</pre><br />Put your password into input, click on &quot;Generate hash&quot; and place generated hash into config file (<i>/src/SkynetUser/SkynetConfig.php</i>) and into compiled version.<br /><br /><pre class="prettyprint linenums">const PASSWORD</pre><br />Ok, let's back to your Skynet Control Panel:<br /><br /><pre class="prettyprint linenums">http://localhost/skynet/skynet_dev.php</pre><br />or<br /><br /><pre class="prettyprint linenums">http://localhost/skynet/skynet.php</pre><br />You should now see request for password. Log in with it.<br />At now, you have simple preconfigured Skynet.<br /><br /><b>REMEMBER:</b> All of your clusters MUST SHARE the same Skynet Key ID.<a name="3_Controlling_Skynet"></a><h1>3. Controlling Skynet</h1>When you launch Skynet via webbrowser you will see Skynet Control Panel. This is the front-end of Skynet. By default, no admin password is set - you must define password hash and place generated hash into config file if you want secure access to Control Panel. At first launch you will see a monit about empty password and information about password hash generation. With Skynet Panel you can control your Skynet - sending requests, receiving resonses, sending commands and checks cluster status. Every cluster has its own Control Panel, so you can control every Skynet Cluster by opening it in webbrowser. Skynet Panel is also a debugger for your Event Listeners - with section &quot;Debug&quot; you can debug your code - informations about debugger are in &quot;Features: Debugger&quot; documentation section. You can also control Skynet by CLI Mode - usage of CLI mode is described in &quot;CLI Mode&quot; section.<br /><br /><i>skynet.php or skynet_dev.php</i><br /><img src="img/skynet.png"><a name="3_1_Control_Panel_overview"></a><h1>3.1. Control Panel overview</h1>Skynet Control Panel can work in 3 modes: connections view, database view and text logs view. <br />You can switch between this two views by switching buttons at the top right corner of Skynet Panel (CONNECTIONS | DATABASE | TXT LOGS).<br /><br /><img src="img/viewmodes.png"><br /><br />In connections view you can sending requests, receiving responses and controls all of data. In database view you can view, edit and delete records stored in Skynet's database like logs, clusters list, options, registry and more.<br /><br /><h2> Connection View </h2><br /><br />Connection View has 6 sections:<br /><br />- <b>Cluster summary informations</b> (1)<br />- <b>Connection mode controller</b> (2)<br />- <b>Clusters list</b> (3)<br />- <b>Status and debugger</b> (4)<br />- <b>Webconsole</b> (5)<br />- <b>Connection Data</b> (6)<br /><br /><img src="img/sections.png"><br /><br /><b>1) Cluster summary informations</b><br />This section shows clusters summary and most important informations about actual clusters.<br />- <b>My address</b> - cluster address<br />- <b>Chain</b> - actual chain value (in every connection chain value is incrementing) and time of last update<br />- <b>Skynet Key ID</b> - your Skynet Key ID<br />- <b>Sleeped</b> - information about Cluster state - sleeped cluster not sends requests and not generates responses<br /><br />- <b>Cluster IP</b> - cluster (server) IP address<br />- <b>Your IP</b> - your IP address<br />- <b>Encryption</b> - data encryption method (default: OpenSSL)<br />- <b>Connections</b> - connections provider (default: CURL)<br /><br />- <b>Broadcasting clusters</b> - number of actual broadcasting clusters<br />- <b>Clusters is DB</b> - number of stored in database connections<br />- <b>Connections attemts</b> - number of actual connections<br />- <b>Successful connections</b> - number of finished actual connections <br /><br /><img src="img/summary.png"><br /><br /><br /><b>2) Connection mode controller</b><br />This is the switch between connections modes. Every Skynet cluster can be in 3 different states:<br />- <b>Idle</b> - when no connections are sending<br />- <b>Single</b> - when you connects to single clusters<br />- <b>Broadcast</b> - when you connects to all clusters stored in database at once<br /><br /><img src="img/modes.png"><br /><br />You can switch between modes by clicking on one of this modes - Skynet will connect and show connection data in &quot;Connection Data&quot; section (6).<br />Connection will be executed via ajax request, so when you change mode Control Panel will not be refreshed and all data will be sent &quot;on fly&quot;.<br /><br /><b>3) Clusters list</b><br />This is the clusters list stored in database.<br />When you connects to cluster or another cluster is connects with your cluster then Skynet stores other cluster address in database.<br /><br /><img src="img/clusters.png"><br /><br />Every cluster entry has 4 fields:<br /><br />- <b>Status</b> (A) (colored square on left whitch shows actual state: GREY icon - idle, GREEN icon - connected, RED icon - connection error<br />- <b>Address</b> (B)- this is the cluster remote address (you can click on address to launch its Control Panel)<br />- <b>Ping</b> (C) - ping in miliseconds (if there is no connection then 0 wil be shown)<br />- <b>Connect button</b> (D) - if you click on &quot;CONNECT&quot; then command for connect to selected cluster will be placed in webconsole and next if you send this command via &quot;Send request&quot; then single connection with cluster will be executed.<br /><br /><img src="img/cluster.png"><br /><br /><b>4) Status and debugger</b><br />You have 6 tabs here:<br />- <b>States</b> - this is the cluster states list generated by Skynet (every part of Skynet can generate its own state). This is a simple info about status of different parts of Skynet<br />- <b>Errors</b> - when errors occurs then it will be shown in this tab. If there is no errors then list will be empty<br />- <b>Config</b> - list of all config values placed in your config file<br />- <b>Console</b> - if you sending commands from webconsole then commands output from console will be shown here <br />- <b>Debug</b> - output of debugger (debugger usage is described in section &quot;Feature: Debugger&quot;)<br />- <b>Listeners</b> - informations about Event Listeners (Listners / Loggers). Your custom listeners are marked here by green colour.<br /><br />In green window you will see Skynet Monitor output.<br /><br /><img src="img/tabs.png"><br /><br />You can switch between tabs by clicking on Tab name.<br />All of data placed here are updated via Ajax when you are connecting to other cluster, so data here is always actual. <br /><br /><b>5) Webconsole</b><br />This is a webconsole for sending commands and requests.<br />You can send commands and parameters from here by typing commands and click on &quot;Send request&quot; button.<br />At the top of webconsole a shortcuts list to commands given from listeners is placed. When you will choose a command from this list then command will be placed in console window.<br />You can define command placed here in your own listeners (more about this is in &quot;registerCommands&quot; section.<br /><br /><img src="img/console.png"><br /><br /><b>6) Connection Data</b><br />This is the output from connections. All of data placed here are generated via ajax-requests &quot;on fly&quot;.<br />There is 3 tabs:<br /><br /><img src="img/connTabs.png"><br /><br />- <b>Plain data</b> - displays all of data (params, commands, etc.) in plain text<br />- <b>Encrypted data</b> - displays the same data but encrypted (Skynet sends encryted data, so you will see here how your encrypted fields looks like in connection)<br />- <b>Raw data</b> - displays raw data whitch is sending and receiving from cluster.<br /><br /><img src="img/connData.png"><br /><br />Connection fields are splitted into sections:<br />- <b>Cluster Info</b> - information about connected cluster<br />- <b>Request Fields</b> {sended} (plain) - raw requested to cluster fields <br />- <b>Response Fields</b> {received} (decrypted) - encrypted fields from cluster response<br />- <b>Request Fields</b> {sended} (encrypted) - encrypted requested to cluster fields <br />- <b>Response Fields</b> {received} (raw) - raw fields from cluster response<br />- <b>SENDED RAW DATA</b> - raw sended data packet<br />- <b>RECEIVED RAW DATA</b> - raw received response packet<br /><br /><br />All &quot;_&quot; and &quot;@_&quot; prefixed parameters are internal Skynet parameters (if not translated fields are displayed).<br /><br />Connection data is built from 2 parts: request and response.<br />Request fields are fields whitch are sended to other cluster when connection is executed.<br />Response fields are fields whitch are received from other cluster when connection is executed.<br />All of both parts are built from parameters and commands list - every field is a pair &quot;key=value&quot;.<br />Most of this parameters are intenal Skynet parameters like cluster address, version, time, key, etc.... You can disable internal parameters display by disabling it in config file.<br /><br />When you connects on &quot;broadcast mode&quot;, or by defining more than one receiver then all of connections data will be shown here and its will be numered by &quot;@Connection 1,2,3, etc...&quot;.<br />If there will be an error with receiving response then no data will be shown here.<br /><br />At the top of connections you can see form to setting connection interval.<br />If value greather than &quot;0&quot; is set then interval will work and Skynet will auto-relaunchs connections &quot;on fly&quot;.<br /><br /><img src="img/interval.png"><br /><br />From here you can also set below options:<br /><br />- <b>Display internal params</b> - if YES then internal Skynet parameters (like Skynet ID, time, hash, etc.) will be displayed<br />- <b>Display @echo</b> - if YES then interal @echo returned parameters will be displayed (Skynet attachs requests fields to response and prefix them by @ - you can disable this option in config file)<br /><br />In left top corner you can also Logout from Panel and change colour theme (default is &quot;dark&quot;):<br /><br /><img src="img/theme.png"><br /><br /><br /><h2> Database View </h2><br /><br />In this view you have access to Skynet's database. Every cluster has its own database created dynamicaly in cluster directory (if SQLite database type is choosen).<br />You have access to all of database tables and records here. Records can be edited and deleted from here (expect &quot;Chain value&quot; record).<br /><br /><img src="img/database.png"><br /><br />At the top of window tables list is placed. You can choose a table from here and then when you click on &quot;Show stored data&quot; all records will be show.<br /><br /><img src="img/tables.png"><br /><br />You can sort records by fields in defined order by change options in form. Records are paginated, so you can choose actual page via &quot;Page&quot; list and click &quot;Execute&quot;.<br />To delete all records in actual table click on the &quot;DELETE ALL RECORDS&quot; button.<br /><br />Every record has 3 buttons:<br /><br />- <b>Generate TXT</b> - generates .txt file from choosen record<br />- <b>Edit</b> - opens record for edition<br />- <b>Delete</b> - deletes choosen record from database<br /><br /><img src="img/dbactions.png"><br /><br />You can define and create you own tables in Event Listeners (more info about it is in &quot;registerDatabase&quot; section).<br /><br />By clicking on &quot;New record&quot; button you can put new record into table manualy.<br /><br /><img src="img/dbnew.png"><br /><br />- <b>Clusters</b> - stores clusters list<br />- <b>Clusters</b> (corrupted/blocked) - stores clusters with connection problems (when Skynet cluster not responds then Skynet marks it as corrupted)<br />- <b>Registry</b> - stores registry options`<br />- <b>Options</b> - stores configuration<br />- <b>Chain</b> - stores actual chain value<br />- <b>Logs: user logs</b> - stored user logs<br />- <b>Logs: Responses</b> - stored responses<br />- <b>Logs: Requests</b> - stored requests<br />- <b>Logs: Echo</b> - stored echo commands<br />- <b>Logs: Broadcasts</b> - stored broadcast commands<br />- <b>Logs: Errors</b> - stored errors<br />- <b>Logs: Access Errors</b> - stored security errors (unathorized access to Panel and incorrect KEY ID in connections)<br />- <b>Logs: Self-updates</b> - stored update procedures<br /><br /><img src="img/tbllist.png"><br /><br /><h2> Information about newest versions </h2><br /><br />At the top left corner after link to GitHub Skynet displays information about newest version available on GitHub. You can disable new versions check in config file.<br /><br /><img src="img/newversion.png"><br /><br /><h2> TXT Logs View </h2><br /><br />This view allow you to browse generated by Skynet txt log files. In this panel you can browse, read, and delete logs saved in your logs directory.<br />By default, Skynet displays all stored logs:<br /><br /><img src="img/txtView.png"><br /><br />When you will click on filename then log will be open in new window.<br />You can also delete specified logs by clicking on &quot;Delete&quot; button.<br /><br />If you want to display logs only from specified event you can choose Event from list:<br /><br /><img src="img/txtTypes.png"><br /><br />If you choose option from list then Skynet will display only logs matches to pattern.<br />As you see table is splitted by columns - Skynet parses this data from filenames whitch are generated by special pattern.<br />Thanks to that you can easy reads your logs finding files by fields:<br /><br />- <b>Filename</b> - log filename<br />- <b>Time</b> - generation time<br />- <b>Event</b> - event type<br />- <b>Context</b> - information if log was saved when request/response was sended or when was received<br />- <b>Cluster</b> - cluster address whitch generated log file<br /><br />Logs created when sending data are marked by green colour.<br />You can also delete all log files by clicking on &quot;Delete ALL TXT FILES&quot; - when button will be clicked on &quot;All&quot; files then all files will be deleted.<br />If it will be clicked when only specified event logs are displayed then only these files will be erased.<br /><a name="3_2_Connection_Modes"></a><h1>3.2. Connection Modes</h1>By default, when Skynet object is started with parameter &quot;true&quot; then Skynet starts in broadcast mode.<br />Skynet has 3 different modes:<br /><br /><b>1) Idle</b><br />When idle mode is set then Skynet not sends any data and there is no connections creates to another clusters.<br />You can set &quot;Idle mode&quot; by clicking on &quot;Idle&quot; button at the top of clusters list window, below the Skynet's logo.<br />When you will send command in idle then no connection will be executed (expects @connect command).<br /><br /><b>2) Single</b><br />When you are connecting to specified cluster address then Skynet will be connect only to it and there will be no connections to others clusters.<br />Every data sended in this mode will be send only to specified cluster. If there will be an error with connection then Skynet will change its mode to &quot;Idle&quot;.<br /><br /><b>3) Broadcast</b><br />In &quot;broadcast&quot; mode every commands and parameters are sended to ALL clusters stored in database.<br />Status of every connection is shown by colour icon on clusters list. When connection is succesful and response data is received then green icon will be shown.<br />If any connection error will occur then icon will change colour to red. If there is no connection with specified clusters then icon will be in grey colour and &quot;Ping&quot; value will be set to &quot;0&quot;.<br />Most od Skynet commands can works in different modes:<br /><br />- <b>me</b> - command is executes only on your cluster, e.g.:<br /><br /><pre class="prettyprint linenums">@sleep me</pre><br />will sleep only your cluster and data will not send to others clusters.<br /><br /><pre class="prettyprint linenums">@sleep &quot;all&quot;</pre><br />will send <b>@sleep</b> command to all clusters stored in database.<br /><br /><pre class="prettyprint linenums">@sleep &quot;address&quot;</pre><br />will send <b>@sleep</b> command only to cluster with &quot;address&quot; address.<br /><br />When you sending parameters without addresses specified, then paremeters will be send to all clusters in broadcast mode, e.g.:<br /><br /><pre class="prettyprint linenums">foo:&quot;bar&quot;</pre><br />will send parameter <i>foo</i> with value <i>bar</i> to all cluster stored in database when you are in broadcast mode.<br /><br />When Skynet connects with another cluster then stored in database clusters list is attached to request - if connected cluster has no any cluster sended in request then its clusters list will be updated with new one.<br />In second way - when respone has clusters in its list whitch you not have in databae then your clusters list will be updated with new one.<br /><br />You can &quot;exit&quot; from broadcast mode when sending parameters by setting &quot;@to&quot; command:<br /><br /><pre class="prettyprint linenums">foo:&quot;bar&quot;;<br />@to &quot;address&quot;;<br /></pre><br />When Skynet is connected to other cluster then &quot;favicon&quot; of Control Panel is set to green.<br /><br />Default mode you can set in config file by changing option:<br /><br /><pre class="prettyprint linenums">$config['core_mode']</pre><br />Possible values:<br /><br />- <b>0</b> - Idle<br />- <b>1</b> - Single<br />- <b>2</b> - Broadcast<a name="4_Request_and_Response"></a><h1>4. Request and Response</h1>Skynet works on request-response based architecture. After sender sends request to responder, responder reads request and generates response for it. Every request is authorized by user-defined Skynet Key ID - unique for every clusters network. Inside code - request is a list of parameters and commands. Those parameters can be set by code (e.g. by Event Listener) or 'handly' via built-in console or command line in CLI mode. Second part is response - an object whitch is generated when request arrives. Response can be generated with built-in in Skynet or created by user Event Listeners. Communication request-response can be estabilished for cluster to cluster connection or via whole clusters network in broadcast mode. Every Skynet cluster is sender (server) and responder (client) at once.<br /><br />In code, those 2 objects are available as:<br /><br /><pre class="prettyprint linenums">use Skynet\Data\SkynetRequest;<br />$request = new SkynetRequest();</pre><br />and<br /><pre class="prettyprint linenums">use Skynet\Data\SkynetResponse;<br />$response = new SkynetResponse();</pre><br />In Event Listeners by easy to use:<br /><br /><pre class="prettyprint linenums">$this-&gt;request</pre><br />and<br /><pre class="prettyprint linenums">$this-&gt;response</pre><br />Every Event Listener has access to them and can manipulate sended/received via those objects data.<a name="4_1_Request"></a><h1>4.1. Request</h1>Request object creates, parses and manipulates on sending to another cluster data. This object offers easy access to all fields sending to another clusters. Every of those fields are params with pairs &quot;key:value&quot; whitch can be receive by another cluster and assigned to their request object. Skynet has some default built-in Event Listeners works on requesting and requested data and you can easily create your own listeners. By the way, this is an idea of Skynet - to create listeners and work with them under framework.<br /><br />Look at an example:<br />Code below creates new request object and sets field called 'foo' with value 'bar':<br /><pre class="prettyprint linenums">use Skynet\Data\SkynetRequest;<br />$request = new SkynetRequest();<br />$request-&gt;set('foo', 'bar');<br /></pre><br />Code below will receive value of field 'foo' from request object:<br /><pre class="prettyprint linenums">$foo = $request-&gt;get('foo');<br /></pre><br />This is the simpliest usage and it's operates on one single <i>key:value</i>request field.<br />With Skynet you can create more specified fields as arrays of params. Code below creates an array of two parameters in single request:<br /><br /><pre class="prettyprint linenums">use Skynet\Data\SkynetRequest;<br />$request = new SkynetRequest();<br />$request-&gt;set('foo', array('key1' =&gt; 'bar1', 'key2' =&gt; 'bar2'));<br /></pre><br />At next, you can receive array like that by:<br /><pre class="prettyprint linenums">$foo = $request-&gt;get('foo');<br />$key1 = $foo['key1'];<br />$key2 = $foo['key2'];<br /></pre><br />If a request field is not set then:<br /><br /><pre class="prettyprint linenums">$foo = $request-&gt;get('FIELD_KEY');<br /></pre><br />always returns NULL, so you can use this to check if any field exists in request, like below:<br /><br /><pre class="prettyprint linenums">if($request-&gt;get('FIELD_KEY') !== null)<br />{<br />  /* do something */<br />}<br /></pre><br />Code above sets single parameter (imagine that this is a single variable) whitch will be send to clusters, but you will also use Skynet to sending commands (they are documented in next sections).<br />Commands can take more that one parameter per command, e.g. if you using command @opt_set then you can specifiy more that one field to one command.<br />Take a look at example:<br /><br /><pre class="prettyprint linenums">use Skynet\Data\SkynetRequest;<br />$request = new SkynetRequest();<br />$request-&gt;set('@reg_set', array('key1' =&gt; 'bar1', 'key2' =&gt; 'bar2');<br /></pre><br />And now:<br /><br /><pre class="prettyprint linenums">key1:&quot;bar1&quot; and key2:&quot;bar2&quot;</pre><br />are still a single parameter. So, with Skynet you can send more parameter where every parameter is an array, let's see an example:<br /><br /><pre class="prettyprint linenums">use Skynet\Data\SkynetRequest;<br />$request = new SkynetRequest();<br />$param1 = array('key1' =&gt; 'bar1', 'key2' =&gt; 'bar2');<br />$param2 = array('key3' =&gt; 'bar3', 'key4' =&gt; 'bar4');<br />$request-&gt;set('@reg_set', array($param1, $param2);<br /></pre><br />Every parametr can be set from 3 different ways:<br /><br />- in PHP code (as above)<br />- via webconsole<br />- via CLI mode<br /><br />Code above is equals to setting parameters from webconsole, e.g.:<br /><br /><pre class="prettyprint linenums">key1:&quot;value1&quot;;<br />key2:&quot;value2&quot;;</pre><br />and equals to the same in CLI mode:<br /><br /><pre class="prettyprint linenums">php skynet.php -b -send &quot;key1:'value1'; key2:'value2';&quot;</pre><br />The Request object works in 2 ways:<br /><br />- on &quot;sender&quot; side you are using request object to create request witch will be send to other clusters<br />- on &quot;receiver&quot; side cluster receives request from sender and operates on sended data by own request object just like above.<br /><br />So, if you sets a field called foo on sender cluster:<br /><br /><pre class="prettyprint linenums">use Skynet\Data\SkynetRequest;<br />$request = new SkynetRequest();<br />$request-&gt;set('foo', 'bar');<br /></pre><br />After send this request to receiver then receiver will be have access to field foo by own request object:<br /><br /><pre class="prettyprint linenums">use Skynet\Data\SkynetRequest;<br />$request = new SkynetRequest();<br />$foo = $request-&gt;get('foo');<br /></pre><br />You will see more about using Request in Event Listeners section.<br />At this time you should know that in Event Listeners you have simpliest access to request object by:<br /><br /><pre class="prettyprint linenums">$this-&gt;request</pre><br />When request is prepared (it can have lot of fields, above we are only sending one for an example) then you can send request to one specified cluster or whole clusters network.<a name="4_2_Response"></a><h1>4.2. Response</h1>Response objects creates and manipulates on response for received requests. After cluster receives request from another cluster response object creates and prepares response depends on received in request parameters or commands.<br />When preparing response for request Skynet launch Events Listeners whitch can add their own fields to response. Returned by response fields are received by request sender and available in its own response object.<br /><br />In code, the response object is creating this way:<br /><br /><pre class="prettyprint linenums">use Skynet\Data\SkynetResponse;<br />$response = new SkynetResponse();<br /></pre><br />Look at an example:<br />Code below creates new response object and fills field called 'foo' with value 'bar':<br /><pre class="prettyprint linenums">use Skynet\Data\SkynetResponse;<br />$response = new SkynetResponse();<br />$response-&gt;set('foo', 'bar');<br /></pre><br />Code below will receive value of field 'foo' from response:<br /><pre class="prettyprint linenums">$foo = $response-&gt;get('foo');<br /></pre><br />Let's see how it works:<br />Sender cluster sends a prepared request to another cluster sending field 'foo' to it:<br /><br />On request sender cluster side:<br /><pre class="prettyprint linenums">use Skynet\Data\SkynetRequest;<br />$request = new SkynetRequest();<br />$request-&gt;set('foo', 'bar');<br /></pre><br />Request above is sending to receiver cluster, at next the receiver cluster gets field 'foo' from own request object.<br /><br />On request receiver side:<br /><pre class="prettyprint linenums">use Skynet\Data\SkynetRequest;<br />$request = new SkynetRequest();<br />$foo = $request-&gt;get('foo');<br /></pre><br />And now, the receiver can prepare response for this request, e.g.:<br /><br />On request receiver (and response sender) side:<br /><pre class="prettyprint linenums">use Skynet\Data\SkynetRequest;<br />use Skynet\Data\SkynetResponse;<br /><br />$request = new SkynetRequest();<br />$response = new SkynetResponse();<br /><br />if($request-&gt;get('foo') == 'bar')<br />{<br />  $response-&gt;set('bar', 'foo');<br />}<br /></pre><br />At next, response is received by request sender and request sender have access to this response by own response object:<br /><br />On request sender (and response receiver) side:<br /><pre class="prettyprint linenums">use Skynet\Data\SkynetResponse;<br />$response = new SkynetResponse();<br /><br />if($response-&gt;get('bar') == 'foo')<br />{<br />  /* do something */<br />}<br /></pre><br />The Response object works in 2 ways:<br /><br />- on &quot;receiver&quot; side cluster generates response for request from sender cluster<br />- on &quot;sender&quot; side response is received and request sender can get data from this request received from response sender via own response object<br /><br />In Event Listeners you will be using response object via:<br /><br /><pre class="prettyprint linenums">$this-&gt;response</pre><br />Response is preparing once when request arrives and response for it is generated.<br />You can generate response only from code via Event Listeners.<a name="5_Features"></a><h1>5. Features</h1>Skynet has lot of features. In this section you will read about most important of them.<a name="5_1_Send/receive_parameters"></a><h1>5.1. Send/receive parameters</h1>Most basic (but most important) feature is remote sending and receiving parameters by request and response objects - everything in Skynet is controlled by this.<br />With Skynet you can setting single parameters like:<br /><br /><pre class="prettyprint linenums">foo:&quot;bar&quot;;</pre><br />or more at once:<br /><br /><pre class="prettyprint linenums">foo:&quot;bar1&quot;;<br />foo2:&quot;bar2&quot;;<br />foo3:&quot;bar3&quot;;</pre><br />All parameters sending and receiving by Skynet are encrypted by default. You can disable data encryption in config file (not recommended) or implements you own algorythms for encryption (at default only simple base64 is included). All of parameters are sending by one single request (or response) - Skynet is packing them into one packet. How it works?<br /><br />You can set parameters by three different ways:<br /><br />- from PHP code via Event Listeners<br />- from webconsole<br />- from CLI<br /><br /><h2> Sending parameters from Event Listener: </h2><br />Let's imagine that we have 2 clusters: <i>skynet1.php</i> and <i>skynet2.php</i> and <i>skynet1.php</i> must send information about <i>foo</i> to <i>skynet2.php</i>.<br />To do this, <i>skynet1.php</i> must prepare request to be send, sets parameter (field) and assign to them value with time and sends prepared request to <i>skynet2.php</i><br />Skynet use special classes called Event Listeners for operating on requesting and receiving data, so all we need to do is to assign our parameter <i>foo</i> to event:<br /><br /><pre class="prettyprint linenums">onRequest()</pre><br />This event is launches two times on both sides - when request is creating (on sender cluster) and when request is received (on receiver). As you see, every event is fired 2 times in 2 different context - as sender and as a receiver.<br /><br />This two contexts are named in Skynet as:<br /><br />- <i>beforeSend</i><br />- <i>afterReceive</i><br /><br />Information about actual context is getting as argument in every event.<br />Depends on this information you can prepare code for 'sender side' and for 'receiver side'.<br /><br />To prepare request (on sender cluster) with our parameter <i>foo</i> we must use context &quot;beforeSend&quot;, becose this context is used when request is under preparation.<br /><br /><i>http://someserver.com/skynet1.php or http://someserver.com/src/SkynetUser/MyListener.php:</i><br /><pre class="prettyprint linenums">public function onRequest($context)<br />{<br />  if($context == &quot;beforeSend&quot;)<br />  {<br />    $this-&gt;request-&gt;set('foo', 'bar');<br />  }<br />}<br /></pre><br />That's it. We creates new parameter (field) called <i>foo</i> and set this to <i>bar</i>.<br />Request will be send when Skynet will be broadcasting another clusters (or via single connection if you specify it). Sended parameter will be available on receiver cluster request object from context <i>afterReceive</i>:<br /><br /><i>http://anotherserver.com/skynet2.php or http://anotherserver.com/src/SkynetUser/MyListener.php:</i><br /><pre class="prettyprint linenums">public function onRequest($context)<br />{<br />  if($context == &quot;afterReceive&quot;)<br />  {<br />    $foo = $this-&gt;request-&gt;get('foo');<br />  } <br />}<br /></pre><br />And now the receiver cluster can prepare response for request above. We will use for that <i>onResponse()</i> event witch works in two context too:<br /><br /><i>http://anotherserver.com/skynet2.php or http://anotherserver.com/src/SkynetUser/MyListener.php:</i><br /><pre class="prettyprint linenums">public function onResponse($context)<br />{<br />  if($context == &quot;beforeSend&quot;)<br />  {<br />    $foo = $this-&gt;request-&gt;get('foo');<br />    if($foo !== null)<br />    {<br />      $this-&gt;response-&gt;set('thanks', 'Thank you!');<br />    }<br />  } <br />}<br /></pre><br />That's it. Request receiver (<i>skynet2.php</i>) will now respond with parameter (field) <i>thanks</i> setted to <i>Thank you!</i>.<br />Now, when a request sender cluster (<i>skynet1.php</i>) receives the response, parameter <i>thanks</i> will be available in its response object in context <i>afterReceive</i>:<br /><br /><i>http://someserver.com/skynet1.php or http://someserver.com/src/SkynetUser/MyListener.php:</i><br /><pre class="prettyprint linenums">public function onResponse($context)<br />{<br />  if($context == &quot;afterReceive&quot;)<br />  {<br />    $responseThanks = $this-&gt;response-&gt;get('thanks');<br />    if($responseThanks !== null)<br />    {<br />      /* Nice. */<br />    }<br />  } <br />}<br /></pre><br />If you want to specify only one cluster receiver when preparing request you should use command:<br /><br /><pre class="prettyprint linenums">@to &quot;CLUSTER_ADDRESS&quot;;</pre><br />Example for specify <i>skynet2.php</i> cluster as only receiver of our request:<br /><i>http://someserver.com/skynet1.php or http://someserver.com/src/SkynetUser/MyListener.php:</i><br /><pre class="prettyprint linenums">public function onRequest($context)<br />{<br />  if($context == &quot;beforeSend&quot;)<br />  {<br />    $this-&gt;request-&gt;set('foo', 'bar');<br />    $this-&gt;request-&gt;set('@to', 'http://localhost/skynet/skynet2.php');<br />  }<br />}<br /></pre><br />The <b>@to</b> command specifying receiver cluster. Only this cluster will receive prepared request as above.<br /><br />Another way is to send parameters via webconsole and CLI mode - those two methods are described more complexed in section &quot;Console &amp; CLI Mode&quot;.<br /><br /><h2> Sending parameters from webconsole: </h2><br />If you want send parameter via webconsole type:<br /><br /><pre class="prettyprint linenums">param:&quot;value&quot;;</pre><br />and click on &quot;Send request&quot;.<br />In our case this could be, e.g.:<br /><br /><pre class="prettyprint linenums">foo:&quot;bar&quot;;</pre><br />Remember that if you sending more than one parameter via webconsole, you must set every parameter in new line and separate them by &quot;;&quot;, e.g.:<br /><br /><pre class="prettyprint linenums">foo:&quot;bar&quot;; <br />foo2:&quot;bar2&quot;; <br />foo3:&quot;bar3&quot;;</pre><br />Then when you click on &quot;Send request&quot; three parameters (fields) will be send in single request.<br />All parameters values should be quoted by [&quot;] char.<br /><br /><h2> Sending parameters from CLI mode: </h2><br />In PHP CLI mode, when you launch Skynet this way you will need to use:<br /><br /><pre class="prettyprint linenums">php skynet.php -send &quot;foo:'bar'; foo2:'bar2';&quot;</pre><a name="5_2_Send/receive_commands"></a><h1>5.2. Send/receive commands</h1>Skynet commands are special types od parameters. They are requests for some kind of action to be executed. Commands are similar to parameters but prefixed by &quot;@&quot;. <br />Every parameter with name prefixed that is interpreted by Skynet as a command. Commands can take parameter (or parameters) and can be call from PHP code (via Event Listeners) or via webconsole or command line in CLI mode.<br /><br />Let's look at the example.<br />In previous section we was sending parameter <i>foo</i> to <i>skynet2.php</i> cluster. We defined receiver cluster by:<br /><br /><pre class="prettyprint linenums">@to</pre><br />This parameter is one of the commands in Skynet.<br />With command you can send to another clusters a request to execute specified by command action, like set value in database, or launch any other action. You can define actions for received commands in Event Listeners:<br /><br /><i>/src/SkynetUser/MyListener.php:</i><br /><pre class="prettyprint linenums">public function onRequest($context)<br />{<br />  if($context == &quot;afterReceive&quot;)<br />  {<br />    if($this-&gt;request-&gt;get('@COMMAND_NAME')<br />    {<br />      /* do something */<br />    }<br />  } <br />}<br /></pre><br />where <i>@COMMAND_NAME</i> is name of command sended by:<br /><br /><pre class="prettyprint linenums">$this-&gt;request('set', '@COMMAND_NAME');</pre><br />or<br /><br /><pre class="prettyprint linenums">@COMMAND_NAME</pre><br />in webconsole.<br /><br /><br />Special type of commands is:<br /><br /><b>return</b><br /><br />It's not called &quot;return&quot;, but its called by single &quot;@&quot; char.<br />When parameter returned with response is prefixed by &quot;@&quot; and not &quot;@&lt;&lt;&quot; that is exacly the echo command. This command do nothing but returns parameters sended in request. You can disable this option (include sended data in response) in config file.<br /><br />Another special type od command is &quot;Skynet control parameter&quot;.<br />Those commands are prefixed by <i>&quot;_skynet&quot;</i> (not by &quot;@&quot;) and controls connection params.<br />You should not use prefix <i>_skynet</i> in your own defined parameters and commands becose this prefixes are reserved for Skynet internal core.<br /><br />Commands can take arguments, e.g. when you're setting receiver cluster address by:<br /><br /><i>/src/SkynetUser/MyListener.php:</i><br /><pre class="prettyprint linenums">$this-&gt;request-&gt;set('@to', 'CLUSTER_ADDRESS');</pre><br /><i>CLUSTER_ADDRESS</i> is here an argument of command <b>@to</b>.<br /><br />If you want to specify argument by webconsole, you must add it after space, e.g.:<br /><br /><pre class="prettyprint linenums">@to &quot;CLUSTER_ADDRESS&quot;;</pre><br />(press &quot;Send request&quot;)<br /><br />You can pass multiple arguments to some commands by separating them with coma -&quot;<b>,</b>&quot;  e.g.:<br /><br /><pre class="prettyprint linenums">@connect CLUSTER_ADDRESS1, CLUSTER_ADDRESS2, CLUSTER_ADDRESS3;</pre><br />(clusters addresses without quotes)<br /><br />Usage in CLI is similar to defining parameters:<br /><br /><pre class="prettyprint linenums">-send &quot;@connect CLUSTER_ADDRESS1, CLUSTER_ADDRESS2, CLUSTER_ADDRESS3;&quot;</pre><br />You will find full commands list in section &quot;Skynet Commands&quot;. Of course you can (and you should) define your own commands in your own Event Listeners to extends Skynet for functionality as you need.<a name="5_3_Self-updating"></a><h1>5.3. Self-updating</h1><b>Event Listener:</b> Skynet\EventListener\SkynetEventListenerUpdater<br /><br />Skynet has built-in function for remotely self-updating its own PHP source code. When you send to clusters the <b>@self_update</b> command, all clusters whitch receive this command will launch update procedure. When you are sending <b>@self_update</b> command you must specify location of skynet cluster with new code. When updating, cluster will connect with it. At next, cluster with new source code will show their code and destination clusters will read this code and replace own code with it. How it works?<br /><br />Let's imagine that we have two Skynet clusters in two different locations: <i>skynet_old.php</i> and <i>skynet_new.php</i>.<br /><br />E.g.:<br /><br /><pre class="prettyprint linenums">http://localhost/foo/skynet_old.php</pre><br />and <br /><br /><pre class="prettyprint linenums">http://localhost/bar/skynet_new.php</pre><br />When <i>skynet_old.php</i> is your old file with some code and <i>skynet_new.php</i> is the newest compiled version (e.g. with new functions whitch you build-in) you can send request to all old clusters from this new one (or from another cluster). Example: if you'll send <b>@self_update</b> command from <i>skynet_new.php</i> to remotely placed <i>skynet_old.php</i> and specify <i>skynet_new.php</i> as source for updating procedure then <i>skynet_old.php</i> will connect with <i>skynet_new.php</i> and ask it for show its own code. At next, <i>skynet_new.php</i> will show it own source code and old cluster will get this. Finally, <i>skynet_old.php</i> will replace own code with this new one. Of course, you can send <b>@self_update</b> command to more than one cluster at once. If you do this then all older clusters will update with new one. You can do this, even if other clusters are on different servers with this one command: <b>@self_update</b>.<br /><br />When sending <b>@self_update</b> command you need specify address to cluster witch is source with new PHP code. After updating, clusters whitch was updated will response with update result: <br />You will see parameters in response:<br /><br /><pre class="prettyprint linenums">@&lt;&lt;self_update_success</pre><br />or if any errors occurs:<br /><br /><pre class="prettyprint linenums">@&lt;&lt;self_update_error</pre><br />with update procedure results.<br /><br /><b>Parameters:</b><br /><i>source</i> - source address to cluster with new code<br /><br /><br /><b>Usage (PHP code):</b><br /><br />You can send <b>@self_update</b> command from event listener:<br /><br /><i>/src/SkynetUser/MyListener.php:</i><br /><pre class="prettyprint linenums">public function onRequest($context)<br />{<br />  if($context == &quot;beforeSend&quot;)<br />  {<br />    $this-&gt;request-&gt;set('@self_update', array('source' =&gt; 'ADDRESS_TO_SOURCE_CLUSTER'));<br />  }<br />}<br /></pre><br />When <i>ADDRESS_TO_SOURCE_CLUSTER</i> is address to cluster with new code, in our case this is:<br /><br /><pre class="prettyprint linenums">http://localhost/bar/skynet_new.php</pre><br />So, command above will update all clusters with code of this one.<br />By default, command sended like that will be send to all clusters, e.g.:<br /><br /><pre class="prettyprint linenums">http://localhost/foo/skynet_old.php</pre><br /><pre class="prettyprint linenums">http://localhost/foo2/skynet_old.php</pre><br /><pre class="prettyprint linenums">http://localhost/foo3/skynet_old.php</pre><br /><pre class="prettyprint linenums">http://localhost/foo4/skynet_old.php</pre><br />If you need to update only one specified cluster you must use <b>@to</b> command, e.g.:<br /><br /><i>/src/SkynetUser/MyListener.php:</i><br /><pre class="prettyprint linenums">public function onRequest($context)<br />{<br />  if($context == &quot;beforeSend&quot;)<br />  {<br />    $this-&gt;request-&gt;set('@self_update', array('source' =&gt; 'ADDRESS_TO_SOURCE_CLUSTER'));<br />    $this-&gt;request-&gt;set('@to', 'ADDRESS_TO_OLD_CLUSTER');<br />  }<br />}<br /></pre><br />When <i>ADDRESS_TO_OLD_CLUSTER</i> is an address to cluster you want to update.<br /><br /><br /><b>Usage (webconsole):</b><br /><br /><pre class="prettyprint linenums">@self_update source:&quot;ADDRESS_TO_SOURCE_CLUSTER&quot;;</pre><br />Command specified like that will send request to all clusters.<br />To specify one cluster as a receiver you add <b>@to</b> command:<br /><br /><pre class="prettyprint linenums">@self_update source:&quot;ADDRESS_TO_SOURCE_CLUSTER&quot;;<br />@to &quot;ADDRESS_TO_OLD_CLUSTER&quot;;<br /></pre><br /><br /><b>Usage (CLI mode):</b><br /><br /><pre class="prettyprint linenums">php skynet_new.php -b -send &quot;@self_update source:'ADDRESS_TO_SOURCE_CLUSTER'&quot;</pre><br />or<br /><br /><pre class="prettyprint linenums">php skynet_new.php -b -send &quot;@self_update source:'ADDRESS_TO_SOURCE_CLUSTER'; @to 'ADDRESS_TO_OLD_CLUSTER'&quot;</pre><br /><br />All updates results are put logs into database and text logs (if enabled).<br />You can see this logs in <b>DATABASE VIEW</b> and in your logs folder.<br />After update procedure all clusters will have THE SAME source code as source.<br /><br />Self-update procedure is executes on destination clusters in <b>onResponse (beforeSend)</b> event.<br /><br /><b>BE CAREFUL WHEN UPDATING:</b> If you accidentally send wrong source or source with errors it is possible to loose connection with clusters. Update only with fully stable and tested compilations.<br /><br /><b>NOTE:</b> When updating remote cluster then connection with updating cluster can be refused for a while and no response will received.<a name="5_4_Self-cloning"></a><h1>5.4. Self-cloning</h1><b>Event Listener:</b> Skynet\EventListener\SkynetEventListenerCloner<br /><br />Self-cloning is functionality whitch allow Skynet to clone itself to another locations. By default this option is disabled in config - if you want to use this you must enable it in your config file. <br /><br />Configuation file is placed in:<br /><pre class="prettyprint linenums">/src/SkynetUser/SkynetConfig.php</pre><br />If you want to enable <i>clone</i> function just set to TRUE option below:<br /><br /><pre class="prettyprint linenums">$config['core_cloner']</pre><br />When <b>@clone</b> command is sent to clusters then every cluster will try to scan all subdirectories where cluster is placed and try to copy to them. After that (if successed) - clusters will broadcast information about new clones on the network to register new ones by other clusters.<br /><br />At first, you should test this option by localhost.<br />Just create directory (and subdirectories in it) when cluster is placed. After that, launch your cluster with command:<br /><br /><pre class="prettyprint linenums">@clone me;</pre><br />Just type command above in webconsole and 'Send Request'.<br />Your cluster should be cloned into all directories in its location, and at next - a new clones should be cloned itselfs into next subdirectiories, and so one...<br /><br />To remotely send <b>@clone</b> command to other clusters, type in webconsole:<br /><br /><pre class="prettyprint linenums">@clone &quot;CLUSTER_ADDRESS&quot;;</pre><br />or<br /><br /><pre class="prettyprint linenums">@clone CLUSTER_ADDRESS1, CLUSTER_ADDRESS2, CLUSTER_ADDRESS3...;</pre><br />(clusters addresses without quotes)<br /><br />or with argument <i>&quot;all&quot;</i> (or without any arguments) to send command to all clusters.<br />In Skynet every command typed without parameters is sending to all clusters by default.<br /><br />Analogously, you can send command in Event Listener:<br /><i>/src/SkynetUser/MyListener.php:</i><br /><pre class="prettyprint linenums">public function onRequest($context)<br />{<br />  if($context == &quot;beforeSend&quot;)<br />  {<br />    $this-&gt;request-&gt;set('@clone', 'all');   <br />  }<br />}<br /></pre><br /><b>Be careful with using this option, becase if you call @clone then Skynet will replicate to ALL directories where it placed.</b><a name="5_5_Sending_emails"></a><h1>5.5. Sending emails</h1><b>Event Listener:</b> Skynet\EventListener\SkynetEventListenerEmailer<br /><br />Skynet has built-it method for sending responses from clusters to specified email address by using PHP's sendmail. When sending emails option is enabled then email is sending every time when response is created on server that create response (or if response is generated from code and e.g. launching from CRON). By default, there is no specified email address of receiver in config file (default address is set) - you must specify email address itself in:<br /><br /><pre class="prettyprint linenums">/src/SkynetUser/SkynetConfig.php</pre><br />by placing your email address in:<br /><br /><pre class="prettyprint linenums">$config['emailer_email_address']</pre><br />After that, if an email address is specified you must enable sending emails on cluster. You can do this by setting Skynet registry option <i>email</i> to value <i>1</i>.<br /><br />To enable sendmail option on cluster, type in webconsole:<br /><br /><pre class="prettyprint linenums">@opt_set email:&quot;1&quot;;<br /></pre><br />This will enable email sending for all clusters in network.<br />If you want to enable option only on specified cluster you must mixed this option with command @to, like that:<br /><br /><pre class="prettyprint linenums">@opt_set email:&quot;1&quot;;<br />@to &quot;CLUSTER_ADDRESS&quot;;<br /></pre><br />(remember about separate commands with coma &quot;;&quot; and press &quot;Send request&quot;)<br /><br />To disable email sending set option to <i>&quot;0&quot;</i>.<br /><br />Sended emails are also logged in database and text logs (if enabled).<a name="5_6_Logging_events"></a><h1>5.6. Logging events</h1><b>Loggers are offered from:</b> Skynet\EventLogger<br />Skynet has complex logging system. It stores events logs (includes requests, responses and more) in two different places - as text files on server and in database. <br />By default, both of these options are enabled but you can disable/or enable them into your config file.<br /><br />Text files logs are stored in specified in config file location (default is: <i>/logs</i>).<br />In database, you will see all of your stored data by switching your <b>View Mode</b> in <i>Skynet Control Panel</i> to <i>Database View</i>.<br /><br />Records with logs can be removed by clicking on <i>Delete</i> button or you can erasing all records by one click via <i>Delete all</i> button. <br /><br />You can easy generate <i>.txt</i> files from specified records by clicking on <i>Generate TXT</i> button on record.<br /><br />Text file logs can be viewed via <i>Control Panel</i> also by switching view to <b>TXT LOGS</b> mode.<br /><br /><h2> Creating custom logs </h2><br /><br />You can create custom logs simply in your Event Listeners.<br />In your listener just use method:<br /><br /><pre class="prettyprint linenums">$this-&gt;addLog($message);</pre><br />where:<br /><br /><i>$message</i> is string value with any text message.<br />By method above a log will be saved into database and into text file in your logs folder.<br /><br /><b>Example:</b><br /><br /><i>/src/SkynetUser/MyListener.php:</i><br /><pre class="prettyprint linenums">public function onResponse($context)<br />{<br />  if($context == &quot;afterReceive&quot;)<br />  {<br />    $this-&gt;addLog('1..2...3...Response received');<br />  }<br />}<br /></pre><br />Code above will save log with message &quot;1..2...3...Response received&quot;.<br />You can use <b>$this-&gt;addLog()</b> in every place of your Event Listener.<br /><br />All custom logs created by method above are stores in database table:<br /><br /><pre class="prettyprint linenums">skynet_logs_user</pre><br />and into logs directory with pattern:<br /><br /><pre class="prettyprint linenums">{LOGS_DIR}/{TIME}_log_{CLUSTER_ADDRESS}_{NUMBER}.txt</pre><br />Event Loggers are based on factory design so you can create your own logging system and register it into Skynet.<br /><br />Loggers factory is placed in class:<br /><br /><pre class="prettyprint linenums">/src/Skynet/EventLogger/SkynetEventLoggersFactory.php</pre><br />You can register custom loggers here:<br /><br /><pre class="prettyprint linenums"> /**<br />  * Registers Event Loggers classes in registry<br />  */<br />  private function registerEventListeners()<br />  {<br />    $this-&gt;register('emailer', new SkynetEventListenerEmailer());<br />    $this-&gt;register('databaseLogger', new SkynetEventListenerLoggerDatabase());<br />    $this-&gt;register('fileLogger', new SkynetEventListenerLoggerFiles());<br />  }<br /></pre><br />Every custom Event Looger must extends abstract class:<br /><br /><pre class="prettyprint linenums">SkynetEventListenerAbstract</pre><br />and implements interface:<br /><br /><pre class="prettyprint linenums">SkynetEventListenerInterface</pre><br />Loggers are executes at the end of code after the Listeners.<br /><br /><h3> Database logs </h3><br /><br />Every Skynet cluster uses it own database to store database logs.<br />At default, Skynet creates tables above to store logs:<br /><br />- <b>Logs: user logs</b> <i>[skynet_logs_user]</i> - stores user log<br />- <b>Logs: Responses</b> <i>[skynet_logs_responses]</i> - stores responses<br />- <b>Logs: Requests</b> <i>[skynet_logs_requests]</i> - stores requests<br />- <b>Logs: Echo</b> <i>[skynet_logs_echo]</i> - stores echo commands<br />- <b>Logs: Broadcasts</b> <i>[skynet_logs_broadcast]</i> - stores broadcast commands<br />- <b>Logs: Errors</b> <i>[skynet_errors]</i> - stores errors<br />- <b>Logs: Access Errors</b> <i>[skynet_logs_access_errors]</i> - stores security errors (unathorized access to Panel and incorrect KEY ID in connections)<br />- <b>Logs: Self-updates</b> <i>[skynet_logs_selfupdate]</i> - stores update procedures<br /><br /><br /><h3> Text logs </h3><br />Text logs are stored in specified in config file directory.<br />You can set directory for logs by setting option:<br /><br /><pre class="prettyprint linenums">$config['logs_dir']</pre><br />in your config file in <i>/src/SkynetUser/SkynetConfig.php</i><br /><br />Every log file is creating by pattern:<br /><br /><pre class="prettyprint linenums">{LOGS_DIR}/{TIME}_{EVENTNAME}_{CLUSTER_ADDRESS}_{NUMBER}.txt</pre><br />Logging specified events can be configured in config file by setting options:<br /><br /><pre class="prettyprint linenums">$config['logs_txt_{EVENTNAME}']</pre><br />to TRUE or FALSE.<br /><br /><b>NOTE: Remember that every event is logged, so your logs directory may includes lot of files after longer time. You should delete old, unused logs every once in a while.</b><a name="5_7_Broadcasting"></a><h1>5.7. Broadcasting</h1>Skynet can work in two different modes: as single connection cluster-cluster or in broadcast mode (peer-to-peer). When Skynet is in brodacast mode all of clusters are broadcasted every time when Skynet is launches. <br /><br />By default, every cluster starts by code below:<br /><br /><pre class="prettyprint linenums">$skynet = new Skynet(true);<br />$service = new SkynetResponder(true);<br /></pre><br />in<br /><br /><pre class="prettyprint linenums">SkynetLauncher()</pre><br />Parameter TRUE in <i>Skynet()</i> constructor starts broadcast mode and renders output (setting this to FALSE will not starts broadcast automaticaly). If you set this to FALSE then you can launch broadcast mode manualy by:<br /><br /><pre class="prettyprint linenums">$skynet-&gt;broadcast();</pre><br />And to enable output:<br /><br /><pre class="prettyprint linenums">echo $skynet-&gt;renderOutput();</pre><br />or simply:<br /><br /><pre class="prettyprint linenums">echo $skynet;</pre><br />Parameter TRUE in <i>SkynetResponder()</i> constructor launch responder (setting this to FALSE will disable responding by Skynet).<br /><br /><h2> Extended broadcast (resending requests) </h2><br /><b>Event Listener:</b> Skynet\EventListener\SkynetEventListenerEcho<br /><br />When Skynet is in broadcast mode then every cluster is requested at start. But notice that when sending requests that requests are sending only to clusters (stored in database) once and the response is returned once only to sender also. <br />What now if you want to resend responses and requests to another clusters? You will need to use <b>@broadcast</b> command.<br /><br />This command tells Skynet to resend requests and responses to next clusters.<br /><br /><b>Example:</b><br /><br />In normal broadcast the first cluster sends to other clusters request with parameter:<br /><br /><pre class="prettyprint linenums">foo:&quot;bar&quot;;</pre><br />Every cluster responds for this by returning response to first cluster (witch was send request). <br />And that's finish. Nothing more will happend.<br /><br />In extended broadcast mode (when <b>@broadcast</b> command is used) request will be resend to the next clusters by other clusters. <br />In this case, when you send request with <i>foo:bar</i> to cluster number 2, then cluster number 2 will connect with cluster 3, 4, 5... and send them exacly the same request (with <i>foo:bar</i>).<br /><br />To enable extended broadcast mode, type in webconsole:<br /><br /><pre class="prettyprint linenums">@broadcast</pre><br />or in Event Listener:<br /><br /><i>/src/SkynetUser/MyListener.php:</i><br /><pre class="prettyprint linenums">public function onRequest($context)<br />{<br />  if($context == &quot;beforeSend&quot;)<br />  {<br />    $this-&gt;request-&gt;set('@broadcast', '1');<br />  }<br />}<br /></pre><br /><b>Note:</b> with extended broadcast you can create more complexed, chained actions, like resending requests decorated by data received from other cluster on the way.<br /><br /><b>Note:</b> when cluster receives <b>@broadcast</b> command no response is generated (it should be sended in <i>onBroadcast()</i>, not in <i>onResponse()</i> event if needed).<a name="5_8_Sleep_and_Wakeup"></a><h1>5.8. Sleep and Wakeup</h1><b>Event Listener:</b> Skynet\EventListener\SkynetEventListenerSleeper<br /><br />Every cluster can be remotely &quot;sleeped&quot;. Sleeped clusters are not broadcasting and they not generate responses.<br /><br />If you want to sleep specified cluster, type in webconsole:<br /><br /><pre class="prettyprint linenums">@sleep &quot;CLUSTER_ADDRESS&quot;;</pre><br />or<br /><br /><pre class="prettyprint linenums">@sleep &quot;CLUSTER_ADDRESS1&quot;, &quot;CLUSTER_ADDRESS2&quot;, &quot;CLUSTER_ADDRESS3&quot;...;</pre><br />If you want to sleep your own cluster, type:<br /><br /><pre class="prettyprint linenums">@sleep me;</pre><br />In <i>Event Listener</i> you will do it with:<br /><br /><i>/src/SkynetUser/MyListener.php:</i><br /><pre class="prettyprint linenums">public function onRequest($context)<br />{<br />  if($context == &quot;beforeSend&quot;)<br />  {<br />    $this-&gt;request-&gt;set('@sleep', '1');<br />  }<br />}<br /></pre><br />Alternatively, you can sleep cluster via setting option <i>sleep</i> to value &quot;1&quot;:<br /><br /><pre class="prettyprint linenums">@opt_set sleep:&quot;1&quot;;</pre><br />In <i>Event Listener</i> (it will work only for THIS cluster):<br /><br /><i>/src/SkynetUser/MyListener.php:</i><br /><pre class="prettyprint linenums">public function onRequest($context)<br />{<br />  if($context == &quot;beforeSend&quot;)<br />  {<br />    $this-&gt;opt_set('sleep', 1);<br />  }<br />}<br /></pre><br />When sleep, you can restore cluster by wake up it.<br />To wakeup cluster just use:<br /><br /><pre class="prettyprint linenums">@wakeup &quot;CLUSTER_ADDRESS&quot;;</pre><br />or<br /><br /><pre class="prettyprint linenums">@wakeup CLUSTER_ADDRESS1, CLUSTER_ADDRESS2, CLUSTER_ADDRESS3...;</pre><br />to wakeup remote cluster.<br /><br />OR:<br /><br /><pre class="prettyprint linenums">@wakeup me;</pre><br />if you want to wake up your own cluster.<br /><br />Alternatively, you can wakeup cluster by setting option <i>sleep</i> to &quot;0&quot;:<br /><br /><pre class="prettyprint linenums">@opt_set sleep:&quot;0&quot;;</pre><a name="5_9_File_transfer"></a><h1>5.9. File transfer</h1><b>Event Listener:</b> Skynet\EventListener\SkynetEventListenerFiles<br /><br />Skynet can gets and writes remote files via one command. You can open any file (if you have correct privilleges) on remote server where Skynet cluster is placed, read its data and get this data in response. You can also put remote file by sending request and defining data to save.<br /><br /><h3> Get remote file </h3><br /><br />To read remote file from server where Skynet cluster is placed use command:<br /><br /><pre class="prettyprint linenums">@fget</pre><br />This command takes one parameter - <i>path</i>:<br /><br /><pre class="prettyprint linenums">path:&quot;PATH_TO_FILE&quot;;</pre><br />By example, after Skynet cluster receives request:<br /><br /><pre class="prettyprint linenums">@fget path:&quot;file.txt&quot;;</pre><br />(or via PHP code):<br /><br /><i>/src/SkynetUser/MyListener.php</i><br /><pre class="prettyprint linenums">public function onRequest($context)<br />{<br />  if($context == &quot;beforeSend&quot;)<br />  {<br />    $this-&gt;request-&gt;set('@fget', array('path' =&gt; 'file.txt'));<br />  }<br />}<br /></pre><br />then cluster whitch receive this request will try to open file called <i>file.txt</i> and read its content.<br />If success then content of this file will be returned in response in parameter:<br /><br /><pre class="prettyprint linenums">@&lt;&lt;fgetFile</pre> <br /><br />This parameter will be have content of readed file.<br />Received remote content will be also saved in <i>/_download</i> directory where Skynet cluster is placed.<br /><br />If any errors occurs (file not exists or no access) then information about it will be returned in paramterer:<br /><br /><pre class="prettyprint linenums">@&lt;&lt;fgetStatus</pre><br />To put a file on remote server where Skynet cluster is placed use command:<br /><br /><br /><h3> Write remote file </h3><br /><br /><pre class="prettyprint linenums">@fput</pre><br />This command takes two parameters:<br /><br /><pre class="prettyprint linenums">path:&quot;PATH_TO_FILE&quot;, data:&quot;DATA_TO_SAVE&quot;;</pre><br />or<br /><br /><pre class="prettyprint linenums">path:&quot;PATH_TO_FILE&quot;, source:&quot;PATH_TO_LOCAL_FILE&quot;;</pre><br />By example, if you want put file <i>file.txt</i> with data <i>some_text</i> just use a command:<br /><br /><pre class="prettyprint linenums">@fput path:&quot;file.txt&quot;, data:&quot;some_text&quot;;</pre><br />or via PHP code:<br /><br /><i>/src/SkynetUser/MyListener.php</i><br /><pre class="prettyprint linenums">public function onRequest($context)<br />{<br />  if($context == &quot;beforeSend&quot;)<br />  {<br />    $this-&gt;request-&gt;set('@fput', array('path' =&gt; 'file.txt', 'data' =&gt; 'some_text'));<br />  }<br />}<br /></pre><br />Against data defining you can send local file by using param &quot;source&quot; as on example below:<br /><br /><pre class="prettyprint linenums">@fput path:&quot;file.txt&quot;, source:&quot;local.txt&quot;;</pre><br />Will send <i>local.txt</i> to remote and save it as <i>file.txt</i><br /><br />Result of file saving/upload will be returned in response in field:<br /><br /><pre class="prettyprint linenums">@&lt;&lt;fputStatus</pre><br /><br /><h3> Delete remote file </h3><br /><br />To delete remote file use command:<br /><br /><pre class="prettyprint linenums">@fdel path:&quot;PATH_TO_FILE&quot;;</pre><br />Result of file delete will be returned in response in field:<br /><br /><pre class="prettyprint linenums">@&lt;&lt;fdelStatus</pre><br /><br /><h3> Delete remote directory </h3><br /><br />To delete remote directory use command:<br /><br /><pre class="prettyprint linenums">@rmdir path:&quot;PATH_TO_DIR&quot;;</pre><br />Result of directory delete will be returned in response in field:<br /><br /><pre class="prettyprint linenums">@&lt;&lt;rmdirStatus</pre><br /><br /><h3> Create remote directory </h3><br /><br />To create remote directory use:<br /><br /><pre class="prettyprint linenums">@mkdir path:&quot;PATH_TO_DIR&quot;;</pre><br />Result of directory creation will be returned in response in field:<br /><br /><pre class="prettyprint linenums">@&lt;&lt;mkdirStatus</pre><br /><br /><h3> Get remote files/dirs listing </h3><br /><br />To receive remote files list use command:<br /><br /><pre class="prettyprint linenums">@ls;</pre><br />Without arguments this command will get remote files and dirs list in cluster's directory<br /><br />To receive list from specified directory use param &quot;path&quot;:<br /><br /><pre class="prettyprint linenums">@ls path:&quot;PATH_ON_REMOTE&quot;;</pre><br />To receive only specified file types create pattern by parameter &quot;pattern&quot; (default pattern value is: *), e.g.:<br /><br /><pre class="prettyprint linenums">@ls path:&quot;some_dir&quot;, pattern:&quot;*.txt&quot;;</pre><br />This will return .txt files list from directory &quot;some_dir&quot;.<br /><br />Returned data from command @ls is receiving by field:<br /><br /><pre class="prettyprint linenums">@&lt;&lt;lsStatus</pre><br />whitch is status of listing, and in:<br /><br /><pre class="prettyprint linenums">@&lt;&lt;lsOutput[]</pre><br />whitch is an array with remote files/dirs list.<br /><br /><br /><h3> Zip packer/unpacker </h3><br /><br />With Skynet you can send ZIP archive into remote cluster and tell Skynet to unpack files from it.<br />To send archive use command:<br /><br /><pre class="prettyprint linenums">@zip_put path:&quot;/path/to/&quot;, file:&quot;local.zip&quot;;</pre><br />Command above will send local file &quot;local.zip&quot; into remote cluster and then archive will be unpacked into directory &quot;/path/to&quot;.<br /><br />Result of operation will be returned by:<br /><br /><pre class="prettyprint linenums">@&lt;&lt;zip_putStatus</pre><br />If you want to pack files on remote cluster and get packed files as zip archive use command:<br /><br /><pre class="prettyprint linenums">@zip_get path:&quot;/path/to/&quot;, pattern:&quot;*&quot;, file:&quot;local.zip&quot;;</pre><br />With command above Skynet will pack remote files from remote directory &quot;/path/to&quot; into zip archive and gets this archive in response.<br />After this an archive will be stored into &quot;/_download&quot; folder with name &quot;local.zip&quot;.<br /><br />Result of this operation will be returned by:<br /><br /><pre class="prettyprint linenums">@&lt;&lt;zip_getStatus</pre><br /><a name="5_10_Remote_system_shell_execution"></a><h1>5.10. Remote system shell execution</h1><b>Event Listener:</b> Skynet\EventListener\SkynetEventListenerExec<br /><br />Skynet allows you to remote shell execution. You can launch shell command (or other application) on remote and Skynet will returns output of it. Note that this option should not be used for nonauthorized operations. Skynet offers 3 different ways to remote shell execution. All of them are based on PHP shell function but they are small different. By sending one parameter you can remotely opens shell execute command and Skynet will return output of the shell execution in response object.<br /><br />First command for remote shell execution is:<br /><br /><pre class="prettyprint linenums">@exec</pre><br />This is based on PHP <i>exec()</i> function, it takes one argument whitch is command to be executed on remote shell.<br />Argument with command to execute must be set in cmd parameter.<br /><br /><b>Example of usage (PHP code):</b><br /><br /><i>/src/SkynetUser/MyListener.php</i><br /><pre class="prettyprint linenums">public function onRequest($context)<br />{<br />  if($context == &quot;beforeSend&quot;)<br />  {<br />    $this-&gt;request-&gt;set('@exec', array('cmd' =&gt; 'COMMAND_TO_EXECUTE'));<br />  }<br />}<br /></pre><br /><b>Example of usage (webconsole):</b><br /><br /><pre class="prettyprint linenums">@exec cmd:&quot;COMMAND_TO_EXECUTE&quot;;</pre><br />Skynet will remotely open system shell (via <i>exec()</i> function), execute <i>COMMAND_TO_EXECUTE</i> and return output via 3 parameters in response:<br /><br /><pre class="prettyprint linenums">@&lt;&lt;execResult ($result)</pre><br /><pre class="prettyprint linenums">@&lt;&lt;execReturn ($return)</pre><br /><pre class="prettyprint linenums">@&lt;&lt;execOutput ($output)</pre><br />Whitch are output of:<br /><br /><pre class="prettyprint linenums">$result = exec($cmd, $output, $return);</pre><br /><br /><b>Example:</b><br />If you want execute command <i>whoami</i> on remote linux based or Windows system, just use:<br /><br /><pre class="prettyprint linenums">@exec cmd:&quot;whoami&quot;;</pre><br />or in PHP code:<br /><br /><i>/src/SkynetUser/MyListener.php</i><br /><pre class="prettyprint linenums">public function onRequest($context)<br />{<br />  if($context == &quot;beforeSend&quot;)<br />  {<br />    $this-&gt;request-&gt;set('@exec', array('cmd' =&gt; 'whoami'));<br />  }<br />}<br /></pre><br />Output of remote execution of command <i>whoami</i> (user name) will be return in response.<br /><br />Another command is:<br /><br /><pre class="prettyprint linenums">@system</pre><br />This is based on PHP <i>system()</i> function, it takes one argument whitch is command to be executed on remote shell.<br />Like above, argument with command to execute must be set in <i>cmd</i> parameter.<br /><br />This command executes remotely:<br /><br /><pre class="prettyprint linenums">$result = system($cmd, $return);</pre><br />And returns in response:<br /><br /><pre class="prettyprint linenums">@&lt;&lt;execResult ($result)</pre><br /><pre class="prettyprint linenums">@&lt;&lt;execReturn ($return)</pre><br />Like above if you want to execute <i>whoami</i> just use:<br /><br /><pre class="prettyprint linenums">@systen cmd:&quot;whoami&quot;;</pre><br />or in PHP code:<br /><br /><i>/src/SkynetUser/MyListener.php</i><br /><pre class="prettyprint linenums">public function onRequest($context)<br />{<br />  if($context == &quot;beforeSend&quot;)<br />  {<br />    $this-&gt;request-&gt;set('@system', array('cmd' =&gt; 'whoami'));<br />  }<br />}<br /></pre><br />Last command is a little bit complicated and it's based on PHP's:<br /><br /><pre class="prettyprint linenums">proc_open()</pre><br />In Skynet, when you use command:<br /><br /><pre class="prettyprint linenums">@proc</pre><br />It will remotely execute <i>proc_open()</i> function with passed process name as first argument.<br /><br />Usage of <b>@proc</b> is different than two previous commands.<br />Process you want to open needs to be passed by <i>proc</i> argument:<br /><br /><pre class="prettyprint linenums">@proc proc:&quot;PROCESS_NAME&quot;;</pre><br />or in PHP code:<br /><br /><i>/src/SkynetUser/MyListener.php</i><br /><pre class="prettyprint linenums">public function onRequest($context)<br />{<br />  if($context == &quot;beforeSend&quot;)<br />  {<br />    $this-&gt;request-&gt;set('@proc', array('proc' =&gt; 'PROCESS_NAME'));<br />  }<br />}<br /></pre><br />Skynet will return output like before but here you can manipulate process <i>pipes</i><br /><br />At this time you must do this manualy, by editing listener or creating your own.<br />By default, <i>proc_open()</i> runs under configuration as below:<br /><br /><pre class="prettyprint linenums">$descriptorspec = array(<br />    0 =&gt; array('pipe', 'r'), <br />    1 =&gt; array('pipe', 'w'), <br />    2 =&gt; array('pipe', 'w') <br />);<br /><br />$process = proc_open($proc, $descriptorspec, $pipes);<br /><br />if(is_resource($process)) <br />{   <br />  $result = stream_get_contents($pipes[1]);<br />  fclose($pipes[0]);<br />  fclose($pipes[1]);   <br />  fclose($pipes[2]);<br />  $return = proc_close($process);<br />}<br /></pre><br />where <i>$proc</i> is process name passed remotely from request and <i>$return</i> is always returned in response via <b>@&lt;&lt;procReturn</b> parameter.<a name="5_11_Remote_PHP_code_execution"></a><h1>5.11. Remote PHP code execution</h1><b>Event Listener:</b> Skynet\EventListener\SkynetEventListenerEval<br /><br />Skynet offers remote PHP code execution functionality. It's based on PHP's <i>eval()</i> function.<br />If you need to execute PHP code sended via request on remote cluster(s) just use:<br /><br /><pre class="prettyprint linenums">@eval</pre><br />Command takes one parameter: <i>php</i> with code source.<br /><br /><b>Example:</b><br /><br />If you want to execute code below on another cluster and takes result:<br /><br /><pre class="prettyprint linenums">&lt;?php return 2+2; ?&gt;</pre><br />you need to do this like these:<br /><br /><pre class="prettyprint linenums">@eval php:&quot;return 2+2;&quot;;</pre><br />or in Event Listener:<br /><br /><i>/src/SkynetUser/MyListener.php</i><br /><pre class="prettyprint linenums">public function onRequest($context)<br />{<br />  if($context == &quot;beforeSend&quot;)<br />  {<br />    $code = 'return 2 + 2;';<br />    $this-&gt;request-&gt;set('@eval', array('php' =&gt; $code));<br />  }<br />}<br /></pre><br />Skynet will send request, remotely execute PHP code and returns output in response field:<br /><br /><pre class="prettyprint linenums">@&lt;&lt;eval</pre><br />In example above output will be:<br /><br /><pre class="prettyprint linenums">@&lt;&lt;eval = 4</pre><a name="5_12_Registry"></a><h1>5.12. Registry</h1>Skynet offers database registry to quick and easy store any data. Data in registry is stored by key-value pairs structure and every Event Listener has access to this registry. <br />You can use registry to store any data, after that you can send this data via request or use it stored data in response.<br /><br />To store any value in registry use command:<br /><br /><pre class="prettyprint linenums">@reg_set foo:&quot;bar&quot;;</pre><br />where <i>foo</i> is the key, and <i>bar</i> is the value<br /><br />To receive stored registry value from remote cluster, use:<br /><br /><pre class="prettyprint linenums">@reg_get foo;</pre><br />After request will be sent, value of the key <i>foo</i> will be returned in response.<br /><br />You can store multiple values at once, by separating them by coma &quot;,&quot;. <br /><br /><b>Examples:</b><br /><br /><pre class="prettyprint linenums">@reg_set foo:&quot;bar&quot;, foo2:&quot;bar2&quot;, foo3:&quot;bar3&quot;;</pre><br /><pre class="prettyprint linenums">@reg_get foo, foo2;</pre><br />To store value in cluster's its own registry, use this code in event listener:<br /><br /><i>/src/SkynetUser/MyListener.php:</i><br /><pre class="prettyprint linenums">public function onRequest($context)<br />{<br />  if($context == &quot;beforeSend&quot;)<br />  {<br />    $this-&gt;reg_set('foo', 'bar');<br />  }<br />}<br /></pre><br />To get value from registry use:<br /><br /><i>/src/SkynetUser/MyListener.php:</i><br /><pre class="prettyprint linenums">public function onRequest($context)<br />{<br />  if($context == &quot;beforeSend&quot;)<br />  {<br />    $foo = $this-&gt;reg_get('foo');<br />  }<br />}<br /></pre><br />Of course, you can use all of this in every event, not only in onRequest().<br /><br />If you want to set/ or get values from specified clusters you must mix request with @to command:<br /><br /><pre class="prettyprint linenums">@reg_set foo:&quot;bar&quot;;<br />@to &quot;CLUSTER_ADDRESS&quot;;<br /></pre><a name="5_13_Echo/Ping"></a><h1>5.13. Echo/Ping</h1><b>Event Listener:</b> Skynet\EventListener\SkynetEventListenerEcho<br /><br />Echo command sends to all clusters a request for another echo (ping). When clusters receives <b>@echo</b> command then they will send ping to another clusters stored in database. You can use this command to update clusters lists (when sending echo, clusters list from database is included in request as a clusters chain).<br /><br />To send <b>@echo</b> command just type:<br /><br /><pre class="prettyprint linenums">@echo</pre><br />This will send command to all clusters in network.<br /><br />Echo command (and <b>@broadcast</b> command) are use special object called <b>SkynetPeer</b>. This object allows to create other connection when cluster is already connected with other (different) cluster. <br />In simply words - this is &quot;connection in connection&quot;. You can read about <b>SkynetPeer</b> in next section.<br /><br /><b>Note:</b> when <b>@echo</b> was sent then no response is generated (response connection is generating by <i>Peer</i>).<br /><br />To execute code in Event Listener when <b>@echo</b> is received you should use <i>onEcho()</i> event instead of <i>onResponse()</i>.<a name="5_14_SkynetPeer"></a><h1>5.14. SkynetPeer</h1>SkynetPeer is a special object that can opens another connection when Skynet requesting or responding to another cluster. You can use <b>SkynetPeer</b> to connect with any other cluster in every event in any situation.<br /><br />By example, let's imagine that cluster number 2 already responding to cluster number 1, and <i>onResponse()</i> event is fired in cluster 2:<br /><br /><i>http://serverONE.com/src/SkynetUser/MyListener.php or http://serverONE.com/skynet1.php (cluster one):</i><br /><pre class="prettyprint linenums">public function onResponse($context)<br />{<br />  if($context == &quot;beforeSend&quot;)<br />  {<br />    /* response to cluster one is creating here */<br />  } <br />}<br /></pre><br />As you see, at this moment response for request from cluster 1 is generating.<br />But what if you want to connect here with another cluster and send request to it? You should use <b>SkynetPeer</b>.<br /><br /><b>Example:</b><br /><br /><i>http://serverTWO.com/src/SkynetUser/MyListener.php or http://serverTWO.com/skynet2.php (cluster two):</i><br /><pre class="prettyprint linenums">use Skynet\Core\SkynetPeer;<br />use Skynet\Data\SkynetRequest;<br />public function onResponse($context)<br />{<br />  if($context == &quot;beforeSend&quot;)<br />  {<br />    /* response to cluster one is creating here */<br />    $skynetPeer = new SkynetPeer();<br />    $newRequest = new SkynetRequest();<br />    $newRequest-&gt;set('foo', 'bar');<br />    $skynetPeer-&gt;assignRequest($newRequest);<br />    $skynetPeer-&gt;connect('CLUSTER_THREE_ADDRESS');<br />  } <br />}<br /></pre><br />In code above we are creating response to cluster number 1.<br />In that response <b>SkynetPeer</b> was created, new request was created and the request was sent to cluster number 3.<br /><br />With this method you can connect with cluster three even when you are actually responding to cluster one.<br />Note that you can also assign actual <b>$request</b> to <b>SkynetPeer</b> instead of creating new one:<br /><br /><pre class="prettyprint linenums">$skynetPeer-&gt;assignRequest($this-&gt;request);</pre><br />Code above will assign actual <b>$request</b> (received from cluster 1) and resend this request to cluster 3.<a name="5_15_SkynetMonitor"></a><h1>5.15. SkynetMonitor</h1>Skynet Monitor is a feature in Control Panel whitch allow you to displaying informations from your Event Listeners.<br />Every Event Listener can send multiple messages called &quot;monits&quot;. All of monit will be displayed in monits area after request will send or response will receive.<br />If you want to create <i>monit message</i> in your Event Listener just use:<br /><br /><pre class="prettyprint linenums">$this-&gt;addMonit($message);</pre><br />where <i>$message</i> should be message string or array with string messages.<br /><br /><b>Example:</b><br /><br /><i>/src/SkynetUser/MyListener.php:</i><br /><pre class="prettyprint linenums">public function onRequest($context)<br />{<br />  if($context == &quot;beforeSend&quot;)<br />  {<br />    $this-&gt;addMonit('1..2..preparing request...');<br />    $this-&gt;addMonit('3..4..preparing request...');<br />  }<br />}<br /></pre><br />Code above will display two monits:<br /><br />- <i>1..2..preparing request...</i><br />- <i>3..4..preparing request...</i><br /><br />in monitor area in Control Panel:<br /><br /><img src="img/monit.png"><a name="5_16_Debugger"></a><h1>5.16. Debugger</h1>Skynet has built-in debugger for debugging variables, arrays and objects in every place of code.<br />Output data from debugger is generated at the end of Skynet code execution so you can debug code in sender and in responder - debug data from both of its will be generated.<br />If you want use debugger outside of listener you must use:<br /><br /><pre class="prettyprint linenums">use Skynet\Debug\SkynetDebug;</pre><br />Then, if you want to debug any data (like variable, array or object), just use:<br /><br /><pre class="prettyprint linenums">$debugger = new SkynetDebug();<br /><br />$myVariable = 'some data';<br />$debugger-&gt;dump($myVariable);<br /></pre><br />In Event Listener it's simpliest, becose you have access to debugger via:<br /><br /><pre class="prettyprint linenums">$this-&gt;debug</pre><br /><b>Example:</b><br /><br /><i>/src/SkynetUser/MyListener.php</i><br /><pre class="prettyprint linenums">public function onResponse($context)<br />{<br />  if($context == &quot;afterReceive&quot;)<br />  {<br />    $myVar = $this-&gt;response-&gt;get('myVar');<br />    $this-&gt;debug-&gt;dump($myVar);<br />  } <br />}<br /></pre><br />Another method in debugger is adding simple message to be shown in defined place in code:<br /><br /><b>Example:</b><br /><i>/src/SkynetUser/MyListener.php</i><br /><pre class="prettyprint linenums">public function onResponse($context)<br />{<br />  if($context == &quot;afterReceive&quot;)<br />  {    <br />    $this-&gt;debug-&gt;txt('Im in response listener');<br />  } <br />}<br /></pre><br />Both of this methods: dump() and txt() adds debug data to debugger registry.<br />All of this data will be displayed in Skynet Control Panel in &quot;Debug&quot; tab:<br /><br /><img src="img/dbg.png"><a name="5_17_SkynetClient"></a><h1>5.17. SkynetClient</h1>Skynet offers a special class called <i>SkynetClient</i> witch can be helpul when you want to integrate Skynet with other applications.<br />Simple example of client class usage is in Skynet's package. It's example file:<br /><br /><pre class="prettyprint linenums">skynet_client.php</pre><br /><i>SkynetClient</i> class can be called from any other application. Only one required term is to place all Skynet classes (from <i>/src</i> directory) in place where your <i>autoloader</i> can access to them.<br />By default, Skynet offers simple autoloader, but you can use your own <i>autoload function</i> and e.g. place Skynet's classes into your <i>/vendor</i> directory.<br /><br />When all of Skynet's classes are available for autoloader then you can create client object by:<br /><br /><pre class="prettyprint linenums">$client = new Skynet\SkynetClient();</pre><br />It creates <i>SkynetClient</i> instance and allow you to sending requests and receiving responses from Skynet clusters.<br />With client object you have access to two <i>public</i> objects:<br /><br /><pre class="prettyprint linenums">$client-&gt;request</pre><br /><pre class="prettyprint linenums">$client-&gt;response</pre><br />Usage of both of them is similar to usage in <i>Event Listeners</i>, so if you want create parameter <i>foo</i> in your request then you can use:<br /><br /><pre class="prettyprint linenums">$client-&gt;request-&gt;set('foo', 'bar');</pre><br />For response receive you can use <i>response</i> object, so if you want to get value of field <i>foo</i> received in response you can use:<br /><br /><pre class="prettyprint linenums">$foo = $client-&gt;response-&gt;get('foo');</pre><br />Connections in client are offered by method:<br /><br /><pre class="prettyprint linenums">$client-&gt;connect($clusterAddress, $newChainValue = null);</pre><br />where:<br /><br /><i>- $clusterAddress</i> is adress to cluster, e.g. <i>&quot;http://localhost/skynet/skynet.php&quot;</i><br /><i>- $newChainValue</i> is new <i>Chain Value</i> to set on cluster [not required]<br /><br />When Skynet client connects to another cluster then <i>public</i> property:<br /><br /><pre class="prettyprint linenums">$client-&gt;isConnected</pre><br />is set to TRUE.<br /><br />So, simple usage of client can looks like code below:<br /><br /><pre class="prettyprint linenums">&lt;?php<br />/* Skynet Client example */<br /><br />spl_autoload_register(function($class)<br />{ <br />  require_once 'src/'.str_replace(&quot;\\&quot;, &quot;/&quot;, $class).'.php'; <br />});<br /><br />/* Create client */<br />$client = new Skynet\SkynetClient();<br /><br />/* Set request field */<br />$client-&gt;request-&gt;set('foo', 'bar');<br /><br />/* Send request and get response */<br />$client-&gt;connect('http://localhost/skynet/skynet.php');<br /><br /><br />/* If connected then get response */<br />if($client-&gt;isConnected)<br />{<br />  echo $client-&gt;response-&gt;get('@foo');<br />}<br /></pre><br />Code above creates client object, sets request field <i>foo</i> to value <i>bar</i> and after that sends request to cluster <i>http://localhost/skynet/skynet.php</i>.<br />Finally if connection if sucessful then client gets response field <i>@foo</i> whitch is returned field from request parameter <i>foo</i>.<br /><br />By default, client creates its own database but not stores remote clusters addresses. If you want to enable clusters storage in client then you must set config option:<br /><br /><pre class="prettyprint linenums">client_registry</pre><br />to <i>TRUE</i>.<br /><br />And that's it. With <i>SkynetClient</i> you can connects with Skynet clusters from any place in your applications.<a name="5_18_Remote_Destroy"></a><h1>5.18. Remote Destroy</h1>Skynet can destroy (delete) remote clusters and resets theirs databases via remote command.<br />If you want do destroy remote cluster use command:<br /><br /><pre class="prettyprint linenums">@destroy;</pre><br />For confirmation this command requires parameter &quot;confirm&quot;, so if you want to destroy remote cluster then type in console:<br /><br /><pre class="prettyprint linenums">@destroy confirm:&quot;1&quot;;</pre><br />or<br /><br /><pre class="prettyprint linenums">@destroy confirm:&quot;yes&quot;;</pre><br /><br />Commands above will destroy all remote clusters.<br />If you want to destroy only specified cluster(s) mix the command with command &quot;@to&quot; as below:<br /><br /><pre class="prettyprint linenums">@destroy confirm:&quot;yes&quot;;<br />@to &quot;CLUSTER_ADDRESS&quot;;<br /></pre><br />or:<br /><br /><pre class="prettyprint linenums">@destroy confirm:&quot;yes&quot;;<br />@to CLUSTER_ADDRESS1, CLUSTER_ADDRESS2, CLUSTER_ADDRESS3...;<br /></pre><br />(clusters addresses without quotes)<br /><br /><br />If you want to reset clusters list on remote cluster use command:<br /><br /><pre class="prettyprint linenums">@reset;</pre><br />This will resets all clusters registries in remote clusters.<br />If you want to reset only specified cluster(s) mix this command with command &quot;to&quot; as below:<br /><br /><pre class="prettyprint linenums">@reset;<br />@to &quot;CLUSTER_ADDRESS&quot;;<br /></pre><br />or:<br /><br /><pre class="prettyprint linenums">@reset;<br />@to CLUSTER_ADDRESS1, CLUSTER_ADDRESS2, CLUSTER_ADDRESS3...;<br /></pre><br />(clusters addresses without quotes)<a name="6_Event_Listeners"></a><h1>6. Event Listeners</h1>Skynet's architecture is based on objects called Event Listeners. They are most important part of every cluster business logic. An idea is that every functionality of cluster is served by appropriate Event Listener. Those listeners are fired when Skynet launchs event like response to request, or request generation/send. Depends on event, listeners functions are called. With Skynet you have some default Event Listeners but the idea is that you will create new ones, depend on your needs.<br /><br /><b>Example:</b><br /><br />When Skynet preparing response to request, event <i>onResponse()</i> is called:<br /><br /><i>/src/SkynetUser/MyListener.php</i><br /><pre class="prettyprint linenums">public function onResponse($context)<br />{<br />  if($context == &quot;afterReceive&quot;)<br />  {<br />    /* some code here */<br />  } <br />}<br /></pre><br />Skynet executes then all of the code placed in this method called <i>onResponse()</i>.<br />As argument to this method Skynet is sending <i>$context</i>. This argument pass two possible states:<br /><br />- afterReceive - when response/or request is received<br />- beforeSend - when response/or request is preparing<br /><br />With example - when Skynet preparing request, an <i>onRequest()</i> event will be called and <i>$context</i> will be set to 'beforeSend'. <br />From other side - when cluster is creating response, then <i>onResponse()</i> with the same context will be called. By mixing these two things (event name and event context) you can build your logic easy.<br /><br />At default, with Skynet you get some Event Listeners, like Emailer, Cloner, Registry, Echo and more. Every of them doing different things. All of listeners must be registered in <i>EventListenersFactory</i>. <br />When they are registered, then all of them will be called one by one when event occured.<br /><br />In every Event Listener you have access to specialy prepared API methods and objects like <i>$response</i>, <i>$request</i> and more.<br /><br /><b>EventLoggers</b> are special types of Event Listeners. They are called at the end of code execution, when all normal Event Listeners was finished their jobs. <br />They are used for logging data like storing data and results from all Event Listeners launches before.<br /><a name="6_1_Event:_onConnect"></a><h1>6.1. Event: onConnect</h1>Event is calling just after connection to another cluster was opened. It passes <i>connector object</i> whitch is instance of <i>SkynetConnectionInterface</i> as an argument. With this event you can get raw encrypted data (response) from connection.<br /><br /><i>/src/SkynetUser/MyListener.php</i><br /><pre class="prettyprint linenums">public function onConnect($conn = null)  <br />{   <br />  /* code executed after connection to cluster */  <br />}<br /></pre><br />To get raw data from connection use:<br /><i>/src/SkynetUser/MyListener.php</i><br /><pre class="prettyprint linenums">public function onConnect($conn = null)  <br />{   <br />  $rawData = $conn-&gt;getData(); <br />}<br /></pre><br />To get address of connection:<br /><i>/src/SkynetUser/MyListener.php</i><br /><pre class="prettyprint linenums">public function onConnect($conn = null)  <br />{   <br />  $address = $conn-&gt;getUrl(); <br />}<br /></pre><br />More available API methods you will find in API Documentation.<a name="6_2_Event:_onRequest"></a><h1>6.2. Event: onRequest</h1>This event is calling two times - when request data is preparing for send and after receiver cluster receives request from sender cluster. <br />Depends on these two situations an argument with situation context is passed.<br /><br />In first situation, when request is preparing to be send, sender will call code below:<br /><br />Request sender cluster:<br /><i>/src/SkynetUser/MyListener.php</i><br /><pre class="prettyprint linenums">public function onRequest($context)<br />{<br />  if($context == &quot;beforeSend&quot;)<br />  {<br />   /* code executes in sender when request is preparing to be send */<br />  } <br />}<br /></pre><br />Everything you will assign to request object above will be included in sended request.<br /><br />In second situation, when request is received by cluster code below is executed:<br /><br />Request receiver cluster:<br /><i>/src/SkynetUser/MyListener.php</i><br /><pre class="prettyprint linenums">public function onRequest($context)<br />{<br />  if($context == &quot;afterReceive&quot;)<br />  {<br />   /* code executes in responder when responder gets request from sender */<br />  } <br />}<br /></pre><br />In code above you have access to whole received request via:<br /><br /><pre class="prettyprint linenums">$this-&gt;request</pre><a name="6_3_Event:_onResponse"></a><h1>6.3. Event: onResponse</h1>Similary to <i>onRequest</i> event, this event is calling also two times - when response data is preparing and after sender cluster receives response to request. <br />Depends on these two situations an argument with context is passed.<br /><br />In first situation, when response is preparing to be send, request receiver will call code below:<br /><i>/src/SkynetUser/MyListener.php</i><br /><pre class="prettyprint linenums">public function onResponse($context)<br />{<br />  if($context == &quot;beforeSend&quot;)<br />  {<br />   /* code executes in responder when response is preparing to be send */<br />  } <br />}<br /></pre><br />Everything you assign to response object above will be included in sended response.<br /><br />In second situation, when response is received by sender cluster code below is executed:<br /><i>/src/SkynetUser/MyListener.php</i><br /><pre class="prettyprint linenums">public function onResponse($context)<br />{<br />  if($context == &quot;afterReceive&quot;)<br />  {<br />   /* code executes in sender when sender receives response */<br />  } <br />}<br /></pre><br />In code above you are have access to whole received response via:<br /><br /><pre class="prettyprint linenums">$this-&gt;response</pre><a name="6_4_Event:_onEcho"></a><h1>6.4. Event: onEcho</h1>Event is calling two times - when response data is preparing for send and after sender cluster receives response. <br />Depends on these two situations an argument with context is passed.<br /><br />In first situation, when response is preparing to be send, receiver will call code below:<br /><i>/src/SkynetUser/MyListener.php</i><br /><pre class="prettyprint linenums">public function onEcho($context)<br />{<br />  if($context == &quot;beforeSend&quot;)<br />  {<br />   /* code executes in responder when response is preparing to be send */<br />  } <br />}<br /></pre><br />Everything you assign to response object above will NOT be send.<br />Response in echo mode is not returned. You can send data from here via only from <b>SkynetPeer</b>.<br /><br />In second situation, when response is received by sender code below is executed:<br /><i>/src/SkynetUser/MyListener.php</i><br /><pre class="prettyprint linenums">public function onEcho($context)<br />{<br />  if($context == &quot;afterReceive&quot;)<br />  {<br />   /* code executes in sender when sender receives response */<br />  } <br />}<br /></pre><br />In code above response will be empty.<a name="6_5_Event:_onBroadcast"></a><h1>6.5. Event: onBroadcast</h1>Event is calling two times - when response data is preparing for send and after sender cluster receives response. <br />Depends on these two situations an argument with context is passed.<br /><br />In first situation, when response is preparing to be send, receiver will call code below:<br /><i>/src/SkynetUser/MyListener.php</i><br /><pre class="prettyprint linenums">public function onBroadcast($context)<br />{<br />  if($context == &quot;beforeSend&quot;)<br />  {<br />   /* code executes in responder when response is preparing to be send */<br />  } <br />}<br /></pre><br />Everything you assign to response object above will be included in sended response.<br />In extended broadcast mode also request will be included to response here.<br /><br />In second situation, when response is received by sender code below is executed:<br /><i>/src/SkynetUser/MyListener.php</i><br /><pre class="prettyprint linenums">public function onBroadcast($context)<br />{<br />  if($context == &quot;afterReceive&quot;)<br />  {<br />   /* code executes in sender when sender receives response */<br />  } <br />}<br /></pre><br />In code above you have access to whole received response via:<br /><pre class="prettyprint linenums">$this-&gt;response</pre><a name="6_6_Event:_onConsole"></a><h1>6.6. Event: onConsole</h1>This event is called when Skynet starts (before any connections) when webconsole input commands are passed. You can place here code whitch must be executed when user type defined command or parameter.<br />In event you have access to console object so you can get all parameters and commands.<br /><br />Access to console is offered by object:<br /><br /><pre class="prettyprint linenums">$this-&gt;console</pre><br />Take a look at example:<br /><br /><i>/src/SkynetUser/MyListener.php</i><br /><pre class="prettyprint linenums">public function onConsole()<br />{<br />  if($this-&gt;console-&gt;isConsoleCommand('foo'))<br />  {<br />     /* do something */<br />  }<br />}<br /></pre><br />Code above checks for command <i>foo</i> exists in input.<br /><br />Method <i>isConsoleCommand('COMMAND_NAME')</i>:<br /><br /><pre class="prettyprint linenums">$this-&gt;console-&gt;isConsoleCommand('foo')</pre><br />returns TRUE if there is command <i>@foo</i> typed in console.<br />Note that argument passed here is without @ prefix.<br />At next, you can depends your actions in EventListener from command existing. <br /><br />To get command data (like its params) you must use<br /><br /><pre class="prettyprint linenums">$this-&gt;console-&gt;getConsoleCommand('COMMAND_NAME');</pre><br />This method returns <i>SkynetCommand</i> object.<br /><br />Every <i>SkynetCommand</i> has two most commonly using methods:<br /><br /><pre class="prettyprint linenums">$command-&gt;getCode()</pre><br />whitch returns command string name (without @ prefix)<br /><br /><pre class="prettyprint linenums">$command-&gt;getParams()</pre><br />whitch returns array with params passed to command.<br /><br /><b>Example:</b><br /><br /><i>/src/SkynetUser/MyListener.php</i><br /><pre class="prettyprint linenums">public function onConsole()<br />{<br />  if($this-&gt;console-&gt;isConsoleCommand('foo'))<br />  {<br />    $command = $this-&gt;console-&gt;getConsoleCommand('foo');     <br />    $name = $command-&gt;getCode(); // foo<br />    $params = $command-&gt;getParams(); // params passed to @foo     <br />  }<br />}<br /></pre><br />This was about getting commands data, if you want to get parameters passed into console (like <i>foo:bar</i>) you must get parameters list via:<br /><br /><i>/src/SkynetUser/MyListener.php</i><br /><pre class="prettyprint linenums">public function onConsole()<br />{ <br />  $params = $this-&gt;console-&gt;getConsoleRequests();   <br />  <br />  foreach($params as $paramName =&gt; $paramValue)<br />  {<br />    // some code here<br />  }<br />}<br /></pre><br /><b>Example:</b><br /><br />If parameter <i>foo</i> with value <i>bar</i> was passed into webconsole by typing:<br /><br /><pre class="prettyprint linenums">foo:bar</pre><br />then you will see this parameter in:<br /><br /><i>/src/SkynetUser/MyListener.php</i><br /><pre class="prettyprint linenums">public function onConsole()<br />{ <br />  $params = $this-&gt;console-&gt;getConsoleRequests();   <br />  <br />  foreach($params as $paramName =&gt; $paramValue)<br />  {<br />    // $paramName &lt;&lt;&lt; foo<br />    // $paramValue &lt;&lt;&lt; bar<br />  }<br />}<br /></pre><br /><b>Returned values:</b><br />Method <i>onConsole()</i> can returns string.<br />If any string is returned it will be display in Console output window in Skynet Control Panel.<br /><br /><b>Example:</b><br /><br /><i>/src/SkynetUser/MyListener.php</i><br /><pre class="prettyprint linenums">public function onConsole()<br />{<br />  if($this-&gt;console-&gt;isConsoleCommand('foo'))<br />  {<br />    return 'Command foo is passed';<br />  }<br />}<br /></pre><a name="6_7_Event:_onCli"></a><h1>6.7. Event: onCli</h1>This event is calling only when Skynet starts from CLI mode and when input commands are passed. You can place here code whitch must be executed when user type defined command or parameter.<br />In event you have access to CLI object so you can get all parameters and commands.<br /><br />Access to CLI commands is offered by object:<br /><br /><pre class="prettyprint linenums">$this-&gt;cli</pre><br />Take a look at example:<br /><br /><i>/src/SkynetUser/MyListener.php</i><br /><pre class="prettyprint linenums">public function onCli()<br />{<br />  if($this-&gt;cli-&gt;isCommand('foo'))<br />  {<br />     /* do something */<br />  }<br />}<br /></pre><br />Code above checks for command <i>foo</i> exists in CLI input.<br /><br />Method <i>isCommand('COMMAND_NAME')</i>:<br /><br /><pre class="prettyprint linenums">$this-&gt;cli-&gt;isCommand('foo')</pre><br />returns TRUE if there is command <i>@foo</i> typed in CLI console.<br />Note that argument passed here is without &quot;-&quot; prefix.<br /><br />Access to specified command parameters is offered by method:<br /><br /><pre class="prettyprint linenums">$this-&gt;cli-&gt;getParams('foo')</pre><br />It returns array with passed arguments.<br />If a command gets only one argument you can access it by:<br /><br /><pre class="prettyprint linenums">$this-&gt;cli-&gt;getParam('foo')</pre><br /><b>Example:</b><br />If you want check for command <i>-foo</i> passed by CLI mode and it params, e.g.:<br /><br /><pre class="prettyprint linenums">php skynet.php -foo param1 param2</pre><br />You will need to do this like this:<br /><br /><i>/src/SkynetUser/MyListener.php</i><br /><pre class="prettyprint linenums">public function onCli()<br />{<br />  if($this-&gt;cli-&gt;isCommand('foo'))<br />  {<br />     $params = $this-&gt;cli-&gt;getParams('foo');<br />     foreach($params as $param)<br />     {<br />       /* some code here */     <br />     }<br />  }<br />}<br /></pre><br />If method <i>onCli()</i> returns any string then this string will be displayed in CLI mode.<br /><br /><b>Example:</b><br /><br /><i>/src/SkynetUser/MyListener.php</i><br /><pre class="prettyprint linenums">public function onCli()<br />{<br />  if($this-&gt;cli-&gt;isCommand('foo'))<br />  {<br />     /* do something */<br />     return 'Something was done.';<br />  }<br />}<br /></pre><a name="6_8_registerCommands"></a><h1>6.8. registerCommands</h1>This is a special method whitch allows you to register your own commands from Event Listener. You can create commands for webconsole and for CLI mode.<br />This method is calling at Skynet start and all of available in webconsole select list commands and commands whitch are displayed in CLI when you viewing help are defined here.<br /><br />In this method you must define two arrays:<br /><br /><pre class="prettyprint linenums">$cli = [];</pre><br /><pre class="prettyprint linenums">$console = [];</pre>  <br /><br />And you must return this arrays as below:<br /><br /><pre class="prettyprint linenums">return array('cli' =&gt; $cli, 'console' =&gt; $console);</pre><br />In <i>$cli</i> array you can define command for CLI mode, in $console array you can define commands for HTML webconsole.<br />You can create multiple commands, let's see an example:<br /><br /><pre class="prettyprint linenums">$cli[] = ['-debug', '', 'Displays connections full debug'];<br />$cli[] = ['-dbg', '', 'Displays connections full debug (alias)'];<br />$cli[] = ['-cfg', '', 'Displays configuration'];<br /></pre><br />Syntax is here:<br /><br /><pre class="prettyprint linenums">$cli[] = ['-COMMAND_NAME', 'POSSIBLE_PARAMS', 'DESCRIPTION'];</pre><br />where <i>POSSIBLE_PARAMS</i> can be string for single param or array for multiple params.<br />If <i>POSSIBLE_PARAMS</i> are empty then params will not be shown in CLI.<br /><br />When creating command for webconsole use syntax:<br /><br /><pre class="prettyprint linenums">$console[] = ['@COMMAND_NAME', 'POSSIBLE_PARAMS', 'DESCRIPTION'];</pre><br />Definition is similary to <i>$cli</i> expects prefix.<br /><br /><b>Example:</b><br /><i>/src/SkynetUser/MyListener.php</i><br /><pre class="prettyprint linenums">public function registerCommands()<br />{    <br />  $cli = [];<br />  $console = [];    <br />  <br />  $cli[] = ['-foo', '', 'bar'];<br />  $cli[] = ['-foo2', 'param1', 'bar2'];<br />  $cli[] = ['-foo3', array('param1', 'param2'), 'bar3'];    <br />  <br />  $console[] = ['@foo', '', 'bar'];<br />  $console[] = ['@foo2', 'param1', 'bar2'];<br />  $console[] = ['@foo3', array('param1', 'param2'), 'bar3'];    <br />  <br />  return array('cli' =&gt; $cli, 'console' =&gt; $console);    <br />}<br /></pre><a name="6_9_registerDatabase"></a><h1>6.9. registerDatabase</h1>With this method in your Event Listener you can define database tables whitch Skynet will create.<br />You can specify more than one table and specify queries to be executed when Skynet starts and checks required tables in database.<br />By example, if you want to use table &quot;foo&quot; with fields: &quot;id, bar1, bar2&quot; you will need to register table in method:<br /><br /><pre class="prettyprint linenums">public function registerDatabase()<br />{<br />  /* code here */<br />}</pre><br /><b>Example:</b><br /><br /><i>/src/SkynetUser/MyListener.php</i><br /><pre class="prettyprint linenums">public function registerDatabase()<br />{<br />  $queries = [];<br />  $tables = [];<br />  $fields = [];<br />  <br />  $queries['foo'] = 'CREATE TABLE foo (id INTEGER PRIMARY KEY AUTOINCREMENT, bar1 VARCHAR (100), bar2 VARCHAR (100))';<br />  <br />  $tables['foo'] = 'My Foo table';<br />  <br />  $fields['foo'] = [<br />    'id' =&gt; 'Description of id Field',<br />    'bar1' =&gt; 'Description of bar1 Field',<br />    'bar2' =&gt; 'Description of bar2 Field'<br />    ];<br />    <br />  return array('queries' =&gt; $queries, 'tables' =&gt; $tables, 'fields' =&gt; $fields);  <br />}</pre><br />Method must returns array with 3 keys:<br /><br />- <i>queries</i> - whitch stores array with queries to execute if table <i>[key]</i> not exists<br />- <i>tables</i> - whitch stores array with tables names where <i>TableName</i> =&gt; <i>FullName</i><br />- <i>fields</i> - whitch stores array with fields descriptions<br /><br />Queries are executes when Skynet starts and checks tables. If table specified here not exists then queries specified here are executed.<br />If you want to specify more than one query per table you can specify queries in array:<br /><br /><pre class="prettyprint linenums">$queries['foo'] = ['query1', 'query2', 'query3' .....];</pre><br />Tables created from here will be available in Database View in Skynet Control Panel.<a name="7_How_to_create_own_Event_Listener?"></a><h1>7. How to create own Event Listener?</h1>Custom Event Listeners should be a heart of your Skynet clusters. That's the idea what Skynet was created for - to offers easy in use architecture and API for creating event based business cluster logic. Let's take a look how to make own Event Listener.<a name="7_1_Step_by_step"></a><h1>7.1. Step by step</h1>By default - an empty template for your listeners is placed here:<br /><br /><pre class="prettyprint linenums">/src/SkynetUser/</pre><br />It's called:<br /><br /><pre class="prettyprint linenums">SkynetEventListenerMyListener.php</pre><br />When you open this file you will see empty methods for each event calling by Skynet.<br />This empty event listener is registered in Skynet by default, so if you place here some code it will be executed when Skynet starts.<br />To registering event listeners Skynet serves a factory class:<br /><br /><pre class="prettyprint linenums">/src/Skynet/EventListener/SkynetEventListenersFactory.php</pre><br />In this factory you will find all listeners assigned to Skynet:<br /><br /><pre class="prettyprint linenums">private function registerEventListeners()<br />{<br />  $this-&gt;register('clusters', new SkynetEventListenerClusters());<br />  $this-&gt;register('cloner', new SkynetEventListenerCloner());<br />  $this-&gt;register('console', new SkynetEventListenerConsole());    <br />  $this-&gt;register('options', new SkynetEventListenerOptions());<br />  $this-&gt;register('registry', new SkynetEventListenerRegistry());<br />  $this-&gt;register('my', new \SkynetUser\SkynetEventListenerMyListener());    <br />  $this-&gt;register('echo', new SkynetEventListenerEcho());<br />  $this-&gt;register('sleeper', new SkynetEventListenerSleeper());<br />  $this-&gt;register('updater', new SkynetEventListenerUpdater());<br />}<br /></pre><br />As you see - your empty listener template is already registered as &quot;my&quot;.<br />If you will create another listeners you would need to register them here if you want to include them in Skynet.<br />Notice that user defined listeners should be exists in namespace:<br /><br /><pre class="prettyprint linenums">\SkynetUser</pre><br />and should be placed into directory:<br /><br /><pre class="prettyprint linenums">/src/SkynetUser/</pre><br />This is for update and compile purposes.<br />When you will updating Skynet's core (e.g. by newest version) your custom classed will be still here in custom folder and after compiling new Skynet's core + your listeners will be included into new version of package.<br /><br />OK. Let's write some code.<br />All events whitch you can use are described in Event Listeners sections.<br />Let's check how to use them and what API methods you can use in your custom listener.<br /><br /><h2> Request and response access </h2><br />In every event listener you have fully access to request and response objects:<br /><br /><pre class="prettyprint linenums">$this-&gt;request</pre><br />and <br /><br /><pre class="prettyprint linenums">$this-&gt;response</pre><br />Setting and getting data from this data are served by </i>set()</i> and <i>get()</i> methods.<br />Take a look at example:<br /><br /><pre class="prettyprint linenums">public function onResponse($context)<br />{<br />  if($context == &quot;beforeSend&quot;)<br />  {<br />    if($this-&gt;request-&gt;get('foo') == 'bar')<br />    {<br />      $this-&gt;response-&gt;set('bar', 'foo');<br />    }  <br />  } <br />}<br /></pre><br />That is the first method.<br />To get fields from both of this objects you can also use arrays:<br /><br /><pre class="prettyprint linenums">$this-&gt;requestsData[]</pre><br />and <br /><br /><pre class="prettyprint linenums">$this-&gt;responseData[]</pre><br />Example:<br /><br /><pre class="prettyprint linenums">public function onResponse($context)<br />{<br />  if($context == &quot;beforeSend&quot;)<br />  {<br />    if(isset($this-&gt;requestsData['foo']) &amp;&amp; $this-&gt;requestsData['foo'] == 'bar')<br />    {<br />      if(!isset($this-&gt;responseData['bar']))<br />      {<br />        $this-&gt;response-&gt;set('bar', 'foo');<br />      }<br />    }  <br />  } <br />}<br /></pre><br />Notice that arrays with fields are read-only and you can only getting data with this method.<br />If you will change any data in <i>$responseData[]</i>, your operation will not be included in response - to do this you must use <i>set()</i> method.<br /><br /><h2> Inheriting </h2><br /><br />Every Event Listener must:<br /><br />- extends <i>\Skynet\EventListener\SkynetEventListenerAbstract</i> class<br />- implements <i>\Skynet\EventListener\SkynetEventListenerInterface</i> interface<br /><br />After creating your listener you should launch Skynet compiler to compile it into cluster file. <br /><br />When you creating much more complicated files structure of your own classes (extending, implementing, etc.) remember that abstract classes files shout be named as:<br /><br /><pre class="prettyprint linenums">ClassNameAbstract</pre><br />Interfaces should be named as:<br /><br /><pre class="prettyprint linenums">ClassNameInterface</pre><br />Traits should be named:<br /><br /><pre class="prettyprint linenums">ClassNameTrait</pre><br />This is for compilation reason - files with abstract classes, interfaces and trait are compiling at the beginning of compiled file (when you inherits from non-existing yet class PHP generates error), so remember of this.<br />You can create files structure as you want - it will all be compiled into standalone file. <br /><br /><b>Notice:</b> when compiling - all <i>use</i> (excepts traits use in class definition) and <i>namespace</i> directives will be erased.<br /><br /><b>API Methods available under Event Listener are described in next section.</b> <a name="7_2_API_Methods"></a><h1>7.2. API Methods</h1><i>SkynetEventListenerAbstract</i> base class offers to your listener some of useful API method to use.<br /><br />Most important of them are request and response objects, but there is more:<br /><br /><h3> Request and Response </h3><br /><pre class="prettyprint linenums">$this-&gt;request</pre><br />This is the main Request object<br /><br /><pre class="prettyprint linenums">$this-&gt;response</pre><br />This is the main Response object<br /><br /><pre class="prettyprint linenums">$this-&gt;requestsData[]</pre><br />Read only array with requests fields indexed by fields keys<br /><br /><pre class="prettyprint linenums">$this-&gt;responseData[]</pre><br />Read only array with response fields indexed by fields keys<br /><br /><br /><h3> Registry </h3><br /><pre class="prettyprint linenums">$this-&gt;reg_set('foo', 'bar');</pre><br />Registry option set<br /><br /><pre class="prettyprint linenums">$foo = $this-&gt;reg_get('foo');</pre><br />Registry option get<br /><br /><br /><h3> Options </h3><br /><pre class="prettyprint linenums">$this-&gt;opt_set('foo', 'bar');</pre><br />System option set<br /><br /><pre class="prettyprint linenums">$foo = $this-&gt;opt_get('foo');</pre><br />System option get<br /><br /><br /><h3> Monits and Logs </h3><br /><pre class="prettyprint linenums">$this-&gt;addMonit('monit message');</pre><br />Creates monit message<br /><br /><pre class="prettyprint linenums">$this-&gt;addLog('log message');</pre><br />Creates log message<br /><br /><br /><h3> Debugging </h3><br /><pre class="prettyprint linenums">$this-&gt;debug-&gt;dump($foo);</pre><br />Debugs (dumps) variable/array/object<br /><br /><pre class="prettyprint linenums">$this-&gt;debug-&gt;txt('debug message');</pre><br />Adds debug message<br /><br /><br /><h3> Clusters informations </h3><br /><pre class="prettyprint linenums">$this-&gt;senderClusterUrl</pre><br />Address of request/response sender<br /><br /><pre class="prettyprint linenums">$this-&gt;receiverClusterUrl</pre><br />Address of request/response receiver<br /><br /><pre class="prettyprint linenums">$this-&gt;myAddress</pre><br />Address of actual cluster<br /><br /><br /><h3> Events and connections informations </h3><br /><pre class="prettyprint linenums">$this-&gt;eventName</pre><br />Name of actual event<br /><br /><pre class="prettyprint linenums">$this-&gt;context</pre><br />Name of actual context<br /><br /><pre class="prettyprint linenums">$this-&gt;connId</pre><br />Number of actual connection<br /><br /><pre class="prettyprint linenums">$this-&gt;sender</pre><br />True if listener was called from request sender, False if listener was called from responder<br /><br /><br /><h3> Core objects </h3><br /><pre class="prettyprint linenums">$this-&gt;auth</pre><br />Authorization object<br /><br /><pre class="prettyprint linenums">$this-&gt;db</pre><br />Database object<br /><br /><pre class="prettyprint linenums">$this-&gt;verifier</pre><br />Verifier object<br /><br />Of course, you can use more of Skynet objects, like Logger, Emailer or Console by create its instances.<br />Full API reference you will find in API Documentation.<br /><br /><b>Example of API methods usage:</b><br /><br /><i>/src/SkynetUser/MyListener.php:</i><br /><pre class="prettyprint linenums">public function onResponse($context)<br />{<br />  if($context == &quot;beforeSend&quot;)<br />  {<br />    /* If request field 'foo' is set */<br />    if($this-&gt;request-&gt;get('foo') !== null)<br />    {<br />      /* get value of request field 'foo' */<br />      $foo = $this-&gt;request-&gt;get('foo');<br />      <br />      /* if request field 'foo' has value 'bar' */ <br />      if($foo == 'bar')<br />      {<br />        /* set response field 'bar' with value 'Foo is Bar' */<br />        $this-&gt;response-&gt;set('bar', 'Foo is Bar');<br />        <br />        /* set monit to show about receive 'bar' */<br />        $this-&gt;addMonit('Received Bar');<br />        <br />        /* set registry field 'foo' to 'bar' if actual value is not 'bar' */<br />        if($this-&gt;reg_get('foo') != 'bar')<br />        {<br />          $this-&gt;reg_set('foo', 'bar');<br />        }<br />      <br />      /* if request field 'foo' is not 'bar' */<br />      } else {<br />        <br />        /* set response and debug field 'foo' */<br />        $this-&gt;response-&gt;set('bar', 'Foo is not Bar');<br />        $this-&gt;debug-&gt;txt('Foo is not Bar');<br />        $this-&gt;debug-&gt;dump($foo);<br />      }<br />      <br />    }<br />    <br />    /* set monits about sender and receiver */<br />    $this-&gt;addMonit('Request received from:'. $this-&gt;receiverClusterUrl);<br />    $this-&gt;addMonit('Sending response from:'. $this-&gt;senderClusterUrl);<br />    <br />    /* save log */<br />    $this-&gt;addLog('Log from cluster: '.$this-&gt;myAddress.' from event: '.$this-&gt;eventName.' with context: '.$this-&gt;context);<br />    <br />    /* check option 'sleep' from options table */<br />    if($this-&gt;opt_get('sleep') == 0)<br />    {<br />      $this-&gt;addLog('My cluster is not sleeped');<br />      <br />      /* if code here was called from responder then save log */<br />      if(!$this-&gt;sender)<br />      {<br />        $this-&gt;addLog('Log saved from responder');<br />      }<br />    }<br />    <br />    /* generate monit with actual response fields */<br />    $responseString = '';<br />    foreach($this-&gt;responseData as $key =&gt; $value)<br />    {<br />      $responseString.= $key.':'.$value.',';      <br />    }<br />    $this-&gt;addMonit('Actual response fields:'. $responseString);<br />  } <br />}<br /></pre><a name="8_Console"></a><h1>8. Console</h1>Skynet offers by default some of useful webconsole commands.<br />With webconsole you can sending requests to another clusters from hand.<a name="8_1_Syntax"></a><h1>8.1. Syntax</h1>- You can send multiple fields at once, but all commands and parameters must be separated by &quot;;&quot; and every parameter/command must be in new line.<br /><br /><pre class="prettyprint linenums">@wakeup &quot;CLUSTER_ADDRESS&quot;;<br />@reg_set foo:&quot;bar&quot;;<br />foo2:&quot;bar2&quot;;<br />foo3:&quot;bar3&quot;;<br /></pre><br />Values of parameters should be quoted by <b>&quot;</b> char<br /><br />- Setting parameters must follow syntax:<br /><br /><pre class="prettyprint linenums">key:&quot;value&quot;;</pre><br />or<br /><br /><pre class="prettyprint linenums">key1:&quot;value1&quot;, key2:&quot;value2&quot;, key3:&quot;value3&quot;;</pre><br />- Passing arguments to commands must be done after space:<br /><br /><pre class="prettyprint linenums">@command &quot;argument&quot;;</pre><br />or <br /><br /><pre class="prettyprint linenums">@command argument1, argument2, argument3;</pre><br />(multiple arguments without quotes)<br /><br /><br />- Passing <i>key:&quot;value&quot;</i> assignments in commands must follow syntax:<br /><br /><pre class="prettyprint linenums">@command key:&quot;value&quot;;</pre><br />or<br /><br /><pre class="prettyprint linenums">@command key1:&quot;value1&quot;, key2:&quot;value2&quot;, key3:&quot;value3&quot;;</pre><br />- You can mix parameters and commands:<br /><br /><pre class="prettyprint linenums">@reg_set foo:&quot;bar&quot;;<br />foo:&quot;bar&quot;;<br />@to &quot;CLUSTER_ADDRESS&quot;;<br /></pre><a name="8_2_Commands_list"></a><h1>8.2. Commands list</h1><b>@add</b><br />Adds specified cluster(s) address(es) to database<br /><pre class="prettyprint linenums">@add &quot;CLUSTER_ADDRESS&quot;;</pre><br />or<br /><pre class="prettyprint linenums">@add CLUSTER_ADDRESS1, CLUSTER_ADDRESS2, CLUSTER_ADDRESS3...;</pre><br />(clusters addresses without quotes)<br /><br /><b>@connect</b><br />Connects with specified cluster(s) address(es)<br /><pre class="prettyprint linenums">@connect &quot;CLUSTER_ADDRESS&quot;;</pre><br />or<br /><pre class="prettyprint linenums">@connect CLUSTER_ADDRESS1, CLUSTER_ADDRESS2, CLUSTER_ADDRESS3...;</pre><br />(clusters addresses without quotes)<br /><br /><b>@to</b><br />Specifies single receiver(s) for request.<br />Use this to mix with other commands.<br /><pre class="prettyprint linenums">@to &quot;CLUSTER_ADDRESS&quot;;</pre><br />or<br /><pre class="prettyprint linenums">@to CLUSTER_ADDRESS1, CLUSTER_ADDRESS2, CLUSTER_ADDRESS3...;</pre><br /><b>@echo</b><br />Sends echo request to all clusters. <br /><pre class="prettyprint linenums">@echo;</pre><br /><b>@sleep</b><br />Sleeps cluster (s). Without any arguments will sleeps all clusters.<br /><pre class="prettyprint linenums">@sleep;</pre><br />or<br /><pre class="prettyprint linenums">@sleep &quot;CLUSTER_ADDRESS&quot;;</pre><br />or<br /><pre class="prettyprint linenums">@sleep CLUSTER_ADDRESS1, CLUSTER_ADDRESS2, CLUSTER_ADDRESS3...;</pre><br />(clusters addresses without quotes)<br />or<br />Sleep my cluster:<br /><pre class="prettyprint linenums">@sleep me;</pre><br /><i>me</i> is an alias to THIS cluster.<br /><br /><b>@wakeup</b><br />Wake-ups cluster (s). Without any arguments will wake-up all clusters.<br /><pre class="prettyprint linenums">@wakeup;</pre><br />or<br /><pre class="prettyprint linenums">@wakeup &quot;CLUSTER_ADDRESS&quot;;</pre><br />or<br /><pre class="prettyprint linenums">@wakeup CLUSTER_ADDRESS1, CLUSTER_ADDRESS2, CLUSTER_ADDRESS3...;</pre><br />(clusters addresses without quotes)<br />or<br />Wake up my cluster:<br /><pre class="prettyprint linenums">@wakeup me;</pre><br /><b>@broadcast</b><br />Enabling extended broadcast (request will be resending by clusters to each others)<br /><pre class="prettyprint linenums">@broadcast;</pre><br /><b>@opt_set</b><br />Sets cluster option on remote<br /><pre class="prettyprint linenums">@opt_set key1:&quot;value1&quot;, key2:&quot;value2&quot;, key3:&quot;value3&quot;...;</pre><br /><b>@opt_get</b><br />Gets cluster option from remote<br /><pre class="prettyprint linenums">@opt_get key1, key2, key3...;</pre><br /><b>@reg_set</b><br />Sets registry value on remote<br /><pre class="prettyprint linenums">@reg_set key1:&quot;value1&quot;, key2:&quot;value2&quot;, key3:&quot;value3&quot;...;</pre><br /><b>@reg_get</b><br />Gets registry value from remote<br /><pre class="prettyprint linenums">@reg_get key1, key2, key3...;</pre><br /><b>@clone</b><br />Executes self-cloning command<br /><pre class="prettyprint linenums">@clone;</pre><br />or<br /><pre class="prettyprint linenums">@clone &quot;CLUSTER_ADDRESS&quot;;</pre><br />or<br /><pre class="prettyprint linenums">@clone CLUSTER_ADDRESS1, CLUSTER_ADDRESS2, CLUSTER_ADDRESS3...;</pre><br />(clusters addresses without quotes)<br />or<br />Clone my cluster:<br /><pre class="prettyprint linenums">@clone me;</pre><br /><b>Note:</b> Remember that <i>cloner</i> is disabled by default in config file. To use this command you must enable it.<br /><br /><b>@self_update</b><br />Self-updates remote cluster<br /><pre class="prettyprint linenums">@self_update source:&quot;ADDRESS_TO_SOURCE_CLUSTER&quot;;</pre><br />or<br /><pre class="prettyprint linenums">@self_update source:&quot;ADDRESS_TO_SOURCE_CLUSTER&quot;, CLUSTER_ADDRESS;</pre><br />or<br /><pre class="prettyprint linenums">@self_update source:&quot;ADDRESS_TO_SOURCE_CLUSTER&quot;, CLUSTER_ADDRESS1, CLUSTER_ADDRESS2, CLUSTER_ADDRESS3...;</pre><br />(clusters addresses without quotes)<br />or<br />Self-update my cluster:<br /><pre class="prettyprint linenums">@self_update source:&quot;ADDRESS_TO_SOURCE_CLUSTER&quot;, me;</pre><br /><b>@exec</b><br />Executes remote shell code<br /><pre class="prettyprint linenums">@exec cmd:&quot;COMMAND_TO_EXECUTE&quot;;</pre><br /><b>@system</b><br />Executes remote shell code - via system()<br /><pre class="prettyprint linenums">@system cmd:&quot;COMMAND_TO_EXECUTE&quot;;</pre><br /><b>@proc</b><br />Starts process on remote cluster - via proc_open()<br /><pre class="prettyprint linenums">@proc proc:&quot;PROCESS_NAME&quot;;</pre><br /><b>@eval</b><br />Executes PHP code on remote cluster - via eval()<br /><pre class="prettyprint linenums">@eval php:&quot;PHP_CODE_TO_EXECUTE&quot;;</pre><br /><b>@ls</b><br />Gets files list from remote<br /><pre class="prettyprint linenums">@ls;</pre><br />or<br /><pre class="prettyprint linenums">@ls path:&quot;/path/to&quot;;</pre><br />or<br /><pre class="prettyprint linenums">@ls path:&quot;/path/to&quot;, pattern:&quot;*.*&quot;;</pre><br /><b>@fget</b><br />Reads remote file and returns its content - via file_get_contents()<br /><pre class="prettyprint linenums">@fget path:&quot;/path/to/file&quot;;</pre><br /><b>@fput</b><br />Writes remote file with defined content or uploads local file to remote - via file_put_contents()<br /><pre class="prettyprint linenums">@fput path:&quot;/path/to/file&quot;, data:&quot;data_to_save&quot;</pre><br />or<br /><pre class="prettyprint linenums">@fput path:&quot;/path/to/file&quot;, source:&quot;/path/to/localfile&quot;</pre><br /><b>@fdel</b><br />Deletes remote file - via unlink()<br /><pre class="prettyprint linenums">@fdel path:&quot;/path/to/file&quot;</pre><br /><b>@mkdir</b><br />Creates directory on remote<br /><pre class="prettyprint linenums">@mkdir path:&quot;/path/to&quot;</pre><br /><b>@rmdir</b><br />Deletes (recursively) directory on remote<br /><pre class="prettyprint linenums">@rmdir path:&quot;/path/to&quot;</pre><br /><b>@destroy</b><br />Destroys (deletes) remote cluster(s)<br /><pre class="prettyprint linenums">@destroy confirm:&quot;1&quot;;</pre><br /><b>@reset</b><br />Resets clusters registry on remote cluster(s)<br /><pre class="prettyprint linenums">@reset;</pre><br /><b>@zip_put</b><br />Send zip archive to remote cluster and unpacks it<br /><pre class="prettyprint linenums">@zip_put path:&quot;/path/to/&quot;, file:&quot;local.zip&quot;;</pre><br /><b>@zip_get</b><br />Packs files on remote cluster and gets them as zip archive<br /><pre class="prettyprint linenums">@zip_get path:&quot;/path/to/&quot;, pattern:&quot;*&quot;, file:&quot;local.zip&quot;;</pre><a name="9_Compiling_Skynet_sources_into_standalone"></a><h1>9. Compiling Skynet sources into standalone</h1>The main idea of Skynet is to use single standalone easy to move files as clusters. Sources placed in <i>/src</i> folder should be compiled via built-in compile script and only compiled clusters should be used. <br />Of course, you can use non-compiled versions but that is not idea of this framework.<br /><br />To compile all sources (including your custom listeners and classes) into single standalone cluster just launch:<br /><br /><pre class="prettyprint linenums">/compiler.php</pre><br />from your browser or CLI Mode.<br />This will compile all sources from <i>/src</i> into <i>/_compiled</i> folder.<br />The name of the compiled file will be:<br /><br /><pre class="prettyprint linenums">skynet_{COMPILATION_TIME}.php</pre><br />Compiled version includes all required classes and is ready to use.<br />You can specify compiler output directory in:<br /><br /><pre class="prettyprint linenums">/src/Skynet/Tools/SkynetCompiler.php</pre><br />You can also compile sources from any cluster when you launching Skynet in CLI mode:<br /><br /><pre class="prettyprint linenums">php skynet.php -compile</pre><a name="10_Extending_&_customizing"></a><h1>10. Extending & customizing</h1>Skynet architecture is easy to extend and to customize. Even core features can be replace by custom ones. In this section you will see how to customize or extends Skynet by own core elements.<a name="10_1_Custom_Data_Encryption"></a><h1>10.1. Custom Data Encryption</h1>By default, Skynet offers all sending and receiving data encryption by:<br /><br />- <i>openSSL</i><br />- <i>Mcrypt</i><br />- <i>base64</i><br /><br />You can create and add your own encryption method by implementing:<br /><br /><pre class="prettyprint linenums">/src/Skynet/Encryptor/SkynetEncryptorInterface.php</pre><br />and adding new encryptor to:<br /><br /><pre class="prettyprint linenums">/src/Skynet/Encryptor/SkynetEncryptorsFactory.php</pre><br /><pre class="prettyprint linenums"> /**<br />  * Registers encryptor classes in registry<br />  */<br />  private function registerEncryptors()<br />  {<br />    $this-&gt;register('openSSL', new SkynetEncryptorOpenSSL());<br />    $this-&gt;register('mcrypt', new SkynetEncryptorMcrypt());<br />    $this-&gt;register('base64', new SkynetEncryptorBase64());<br />  }<br /></pre><br />In registration method above you can set encryption method in <i>/src/SkynetUser/SkynetConfig.php</i> file by changing option:<br /><br /><pre class="prettyprint linenums">$config['core_encryptor']</pre><br />Where option value is the name of encryptor defined in register method in factory.<br /><br />Encryptors are placed in directory:<br /><pre class="prettyprint linenums">/src/Skynet/Encryptor/</pre><a name="10_2_Custom_Connection_Classes"></a><h1>10.2. Custom Connection Classes</h1>By default, Skynet offers two connection methods:<br /><br />- via <i>cURL</i> library<br />- via <i>file_get_contents()</i> function<br /><br />You can create and add your own connection class by implementing:<br /><br /><pre class="prettyprint linenums">/src/Skynet/SkynetConnectionInterface.php</pre><br />and registering new class in factory:<br /><br /><pre class="prettyprint linenums">/src/Skynet/SkynetConnectionsFactory.php</pre><br />To register new connection provider class just add it to register method:<br /><br /><pre class="prettyprint linenums"> <br /> /**<br />  * Registers all connection adapters into registry<br />  */<br />  private function registerConnectors()<br />  {<br />    $this-&gt;register('file_get_contents', new SkynetConnectionFileGetContents());<br />    $this-&gt;register('curl', new SkynetConnectionCurl());<br />  }<br /></pre><br />After that you will need to set connection method in <i>/src/SkynetUser/SkynetConfig.php</i> file by changing option:<br /><br /><pre class="prettyprint linenums">$config['core_connection_type']</pre><br />Where option value is the name of connector defined in register method in factory.<br /><br />Connection providers are placed in directory:<br /><pre class="prettyprint linenums">/src/Skynet/Connection/</pre><a name="10_3_Custom_Commands_Shortcuts"></a><h1>10.3. Custom Commands Shortcuts</h1>Skynet offers quick shortcut commands list above webconsole.<br />This list is hardcoded but you can add here your own commands in:<br /><br /><pre class="prettyprint linenums">/src/Skynet/Console/SkynetConsole.php</pre><br />Custom command can be added to list by:<br /><br /><pre class="prettyprint linenums">$this-&gt;addCommand()</pre><br />method in class constructor.<br /><br />Custom commands can be defined in Event Listeners also via<br /><br /><pre class="prettyprint linenums">registerCommands()</pre><br />method.<a name="10_4_Custom_Themes"></a><h1>10.4. Custom Themes</h1>You can change CSS theme of <i>Skynet Control Panel</i> by adding different theme in file:<br /><br /><pre class="prettyprint linenums">/src/Skynet/Renderer/Html/SkynetRendererHtmlThemes.php</pre><br />After that you will need to change theme name in main config file:<br /><br /><pre class="prettyprint linenums">$config['core_renderer_theme']</pre><a name="11_Configuration"></a><h1>11. Configuration</h1>Skynet configuration is placed in file:<br /><pre class="prettyprint linenums">/src/SkynetUser/SkynetConfig.php</pre><br />When compiling, this file will be included at the beginning of compiled standalone version.<br />Remember that you must recompile all of your clusters (or update config manually) when you will change configuration data.<br /><br /><h3> Configuration options: </h3><br /><br />const <b>KEY_ID</b> -&gt; string <i>default: '1234567890'</i><br />Your Skynet Key ID <br /><br />const <b>PASSWORD</b> -&gt; string <i>default: ''</i><br />Admin password for Skynet Control Panel  <br /><br /><pre class="prettyprint linenums">private static $config = [</pre><br /><h2> A) Core configuration - base options: </h2><br /><br /><b>core_secure</b> -&gt; bool:[true|false] <i>default: true</i><br />If TRUE, Skynet will verify KEY ID in every response, if FALSE - you will able to connect without key (USE THIS ONLY FOR TESTS!!!) <br /><br /><b>core_raw</b> -&gt; bool:[true|false] <i>default: false</i><br />If TRUE all sending and receiving data will be encrypted, if FALSE - all data will be send in plain text <br /><br /><b>core_updater</b> -&gt; bool:[true|false] <i>default: true</i><br />If TRUE Skynet will enable self-remote-update engine, if FALSE - self-remote-engine will be disabled <br /><br /><b>core_cloner</b> -&gt; bool:[true|false] <i>default: false</i><br />If TRUE - cloner will be enabled and listening for clone command */<br /><br /><b>core_check_new_versions</b> -&gt; bool:[true|false] <i>default: true</i><br />Enables or disables new version check   <br />    <br /><b>core_urls_chain</b> -&gt; bool:[true|false] <i>default: true</i><br />If TRUE - Skynet will include urls chain to requests/responses and will be updates new clusters from it  <br />  <br /><b>core_mode</b> -&gt; integer:[0|1|2] <i>default: 2</i><br />Default Skynet Mode. 0 = Idle, 1 = Single, 2 = Broadcast<br />This is uses by Control Panel by default when you opens Control Panel<br /><br /><b>core_encryptor</b> -&gt; string:[openSSL|mcrypt|base64|...] <i>default: 'openSSL'</i><br />Name of registered class used for encrypting data <br /><br /><b>core_encryptor_algorithm</b> -&gt; string <i>default: 'aes-256-ctr'</i><br />Algorithm for OpenSSL encryption<br /><br /><b>core_renderer_theme</b> -&gt; string:[dark|light|raw|...] <i>default: 'dark'</i><br />Theme CSS for HTML Renderer <br /><br /><b>core_date_format</b> -&gt; string <i>default: 'H:i:s d.m.Y'</i><br />Date format for date() function    <br />    <br /><b>core_admin_ip_whitelist</b> -&gt; string[] <i>default: []</i><br />IP Whitelist for accepting access to Control Panel. If array is empty then Control Panel allows access from all IP's<br />If array have IP addresses then Control Panel will be accessible only from this addresses<br />   <br /><b>core_open_sender</b> -&gt; bool:[true|false] <i>default: false</i><br />If TRUE then Skynet will always sends requests when open (without login to Control Panel)<br />If FALSE then Skynet will sends requests only when logged in Control Panel<br /><br /><br /><h2> B) Client configuration </h2>       <br />    <br /><b>client_registry</b> -&gt; bool:[true|false] <i>default: false</i><br />If TRUE, Skynet Client will store clusters in its registry<br />If FALSE then Skynet Client will not store remote clusters addresses in its database<br />   <br /><b>client_registry_responder</b> -&gt; bool:[true|false] <i>default: false</i><br />If TRUE, Skynet Responder will save cluster when receive connection from client <br />If FALSE then Skynet Responder will not store Client addresses.<br />    <br />    <br /><h2> C) Translate configuration - Control Panel display mode: </h2><br /><br /><b>translator_config</b> -&gt; bool:[true|false] <i>default: true</i><br />If TRUE config view will be translated<br /><br /><b>translator_params</b> -&gt; bool:[true|false] <i>default: true</i><br />If TRUE Skynet inetrnal params will be translated<br /><br /><br /><h2> D) Core configuration - connections with clusters: </h2><br /><br /><b>core_connection_mode</b> -&gt; string:[host|ip] <i>default: 'host'</i><br />Specified connection addresses by host or IP.<br />Skynet can work by hostnames or by IP addresses - it can be set here.<br /><br /><b>core_connection_type</b> -&gt; string:[curl|file_get_contents|...] <i>default: 'curl'</i><br />Name of registered class used for connection with clusters <br /><br /><b>core_connection_protocol</b> -&gt; string:[http|https] <i>default: 'http://'</i><br />Connections protocol (http:// or https://)<br /><br /><b>core_connection_ssl_verify</b> -&gt; bool:[true|false] <i>default: false</i><br />Only for cURL, set to FALSE to disable verification of SSL certificates <br /><br /><b>core_connection_curl_output</b> -&gt; bool:[true|false] <i>default: false</i><br />If true CURL will display connection output in CLI mode (VERBOSE OPTION)        <br />   <br /><b>core_connection_ip_whitelist</b> -&gt; string[] <i>default: []</i><br />IP Whitelist for accepting requests from, if empty then all IP's has access to response<br /><br /><br /><h2> E) Emailer configuration: </h2><br /><br /><b>core_email_send</b> -&gt; bool:[true|false] <i>default: true</i><br />TRUE for enable auto-emailer engine for responses, FALSE to disable <br /><br /><b>core_email_send</b> -&gt; bool:[true|false] <i>default: true</i><br />TRUE for enable auto-emailer engine for requests, FALSE to disable <br /><br /><b>core_email_address</b> -&gt; [email] <i>default: 'your@email.com'</i><br />Specify email address for receiving emails from Skynet <br /><br /><br /><h2> F) Response: </h2><br /><br /><b>response_include_request</b> -&gt; bool:[true|false] <i>default: true</i><br />If TRUE, response will be attaching requests data with @ prefix, if FALSE requests data will not be included into response <br /><br /><br /><h2> G) Logs: </h2><br /><br /><b>logs_errors_with_full_trace</b> -&gt; bool:[true|false] <i>default: true</i><br />If TRUE then Skynet will save full debug trace in errors logs<br />   <br /><b>logs_txt_include_secure_data</b> -&gt; bool:[true|false] <i>default: true</i><br />Set TRUE to log Skynet Key ID and Hash (use this only for debug, not in production<br />       <br /><b>logs_txt_include_clusters_data</b> -&gt; bool:[true|false] <i>default: true</i><br />Set TRUE to log clusters URLs and clusters chain (use this only for debug, not in production<br /><br /><b>logs_dir</b> -&gt; string:[path/] <i>default: 'logs/'</i><br />Specify path to dir where Skynet will save logs, or leave empty to save logs in Skynet directory <br /><br /><b>logs_txt_*</b> -&gt; bool:[true|false] <i>default: true</i><br />Enable or disable txt logs for specified Event <br /><br /><b>logs_txt_include_internal_data</b> -&gt; bool:[true|false] <i>default: true</i><br />If TRUE, Skynet will include internal params in txt logs <br /><br /><b>logs_db_*</b> -&gt; bool:[true|false] <i>default: true</i><br />Enable or disable database logs for specified Event <br /><br /><b>logs_db_include_internal_data</b> -&gt; bool:[true|false] <i>default: false</i><br />If TRUE, Skynet will include internal params in database logs <br /><br /><br /><h2> H) Database configuration: </h2><br /><br /><b>db</b> -&gt; bool:[true|false] <i>default: true</i><br />Enable or disable database support. If disabled some of functions of Skynet will not work  <br /><br /><b>db_type</b> -&gt; string:[dsn] <i>default: 'sqlite'</i><br />Specify adapter for PDO (sqlite is recommended)  <br /><br /><br /><b>db_host</b> -&gt; string <i>default: '127.0.0.1'</i><br />Database host<br /><br /><b>db_user</b> -&gt; string <i>default: 'root'</i><br />Database username<br /><br /><b>db_password</b> -&gt; string <i>default: ''</i><br />Database password<br /><br /><b>db_dbname</b> -&gt; string <i>default: 'skynet'</i><br />Database name<br /><br /><b>db_encoding</b> -&gt; string <i>default: 'utf-8'</i><br />Database encoding<br /><br /><b>db_port</b> -&gt; integer <i>default: 3306</i><br />Database port<br /><br /><b>db_file</b> -&gt; string:[filename] <i>default: ''</i><br />SQLite database filename, leave empty to let Skynet specify names itself (recommended)  <br /><br /><b>db_file</b> -&gt; string:[path/] <i>default: ''</i><br />SQLite database path, if empty db will be created in Skynet directory  <br /><br /><br /><h2> I) Debug options </h2><br /><br /><b>console_debug</b> -&gt; bool:[true|false] <i>default: true</i><br />If TRUE, console command debugger will be displayed in Control Panel when parsing input <br /><br /><b>debug_exceptions</b> -&gt; bool:[true|false] <i>default: false</i><br />If TRUE, debugger will show more info like line, file and trace on errors in Control Panel<br /><br /><b>debug_internal</b> -&gt; bool:[true|false] <i>default: true</i><br />If TRUE, internal params will be displayed in connection data   <br />     <br /><b>debug_echo</b> -&gt; bool:[true|false] <i>default: true</i><br />If TRUE, internal @echo params will be show in Control Panel<br />     <br /><b>debug_key</b> -&gt;  bool:[true|false] <i>default: true</i><br />If TRUE, KEY ID will be displayed in Control Panel<a name="12_CLI_mode"></a><h1>12. CLI mode</h1>Skynet also works in CLI mode with different interface.<br />To launch Skynet in CLI mode just launch:<br /><br /><pre class="prettyprint linenums">php skynet.php</pre><br />In CLI mode, Skynet starts with status &quot;0&quot; (Idle), no connections are launched at start, you must execute connection manually by specified command.<br /><br />All commands must be prefixed by &quot;-&quot; char. You can join commands in one line.<br />Arguments for commands should be quoted by &quot; chars, e.g.:<br /><br /><pre class="prettyprint linenums">php skynet.php -command &quot;argument&quot;</pre><br />or<br /><pre class="prettyprint linenums">php skynet.php -command &quot;argument1&quot; &quot;argument2&quot; &quot;argument3&quot;...</pre><br />This version of Skynet serves you some commands to use:<br /><br /><b>-debug</b><br />Displays connection data<br /><br /><b>-dbg</b><br />Displays connection data (shorten alias for command &quot;-debug&quot;)<br /><br /><b>-cfg</b><br />Displays configuration<br /><br /><b>-status</b><br />Displays cluster status (KEY, chain value, etc.)<br /><br /><b>-out [field] or [field1, field2...]</b><br />or<br /><b>-out [field] [field2] [field3]</b><br />Displays only specified fields returned from response, example:<br /><pre class="prettyprint linenums">php skynet.php -broadcast -out &quot;foo&quot;</pre><br />Example above will display only value of field &quot;foo&quot; from response at output.<br />You can use this to integration with another apps like CRON, and specify here defined output data.<br />You can specify more than one field - just seperate them by coma, example:<br /><pre class="prettyprint linenums">php skynet.php -b -out &quot;foo1, foo2, foo3&quot;</pre><br />or:<br /><pre class="prettyprint linenums">php skynet.php -b -out &quot;foo1&quot; &quot;foo2&quot; &quot;foo3&quot;</pre><br />It will display values from fields foo1, foo2 and foo3 returned from response<br /><br /><br /><b>-connect [address]</b><br />Connects to single specified address, example:<br /><pre class="prettyprint linenums">php skynet.php -connect &quot;http://localhost/skynet/skynet.php&quot;</pre><br />It will connect to cluster with address <i>http://localhost/skynet/skynet.php</i><br /><br /><b>-c [address]</b><br />Connects to single specified address (shorten alias for command &quot;-connect&quot;), example:<br /><pre class="prettyprint linenums">php skynet.php -c &quot;http://localhost/skynet/skynet.php&quot;</pre><br />It is the same like &quot;-connect&quot; command.<br /><br /><b>-broadcast</b><br />Broadcasts all addresses (starts Skynet)<br />It will connect to all clusters stored in database (status &quot;2&quot; - Broadcast).<br />At default, no output data will be displayed. If you want display connection debug data - use command &quot;-debug&quot; or &quot;-dbg&quot;, example:<br /><pre class="prettyprint linenums">php skynet.php -broadcast -debug</pre><br /><b>-b</b><br />Broadcasts all addresses (starts Skynet) (shorten alias for command &quot;-broadcast&quot;)<br /><br /><b>-send [&quot;request params&quot;]</b><br />Sends request from command line, syntax of request params is the same like in webconsole expects quotes.<br />Syntax is similar to webconsole expects quoting and separating commands/params by new line - in CLI mode all &quot; (quote) chars must be replaced by ' char (apostrofe), example:<br /><pre class="prettyprint linenums">php skynet.php -broadcast -send &quot;foo:'bar'&quot;</pre><br />It will connect to all clusters and send request with two parameter: <i>foo</i>.<br />Commands and parameters in &quot;-send&quot; command must be splitted by semicolon and space after semicolon: &quot;; &quot;, example:<br /><pre class="prettyprint linenums">php skynet.php -broadcast -send &quot;foo:'bar'; foo2:'bar2'&quot;</pre><br />It will send two parameters: foo and foo2 by request.<br />Remember about <i>space</i> after semicolon, example below:<br /><pre class="prettyprint linenums">php skynet.php -broadcast -send &quot;foo:'bar';foo2:'bar2'&quot;</pre><br />Will send only one parameter: <i>foo</i> with value &quot;<i>bar;foo2:bar2</i>&quot;<br /><br /><br /><b>-db [table name] optional: [page] [sortByColumn] [ASC|DESC]</b><br />Displays logs records from specified table in database, example:<br /><pre class="prettyprint linenums">php skynet.php -db &quot;skynet_clusters&quot;</pre><br />It will display records from table <i>skynet_clusters</i><br />Example 2:<br /><pre class="prettyprint linenums">php skynet.php -db &quot;skynet_clusters&quot; 2 id asc</pre><br />It will display page 2 of records from table <i>skynet_clusters</i> sorted by <i>id</i> column in ascending order.<br /><br /><b>-db [table name] -del [record ID]</b><br />Erases record from database table, example:<br /><pre class="prettyprint linenums">php skynet.php -db &quot;skynet_clusters&quot; -del 5</pre><br />It will erase record with <i>id = 5</i> from table <i>skynet_clusters</i><br /><br /><b>-db [table name] -truncate</b><br />Erases ALL RECORDS from database table, example:<br /><pre class="prettyprint linenums">php skynet.php -db &quot;skynet_clusters&quot; -truncate</pre><br />It will erase all records from table <i>skynet_clusters</i><br /> <br /><b>-sleep</b><br />Sleeps this cluster.<br />It sets option <i>sleep</i> to &quot;1&quot;<br /><br /><b>-wakeup</b><br />Wakeups this cluster<br />It sets option <i>sleep</i> to &quot;0&quot;<br /><br /><b>-help</b><br />Displays help<br /><br /><b>-h</b><br />Displays help (shorten alias for command &quot;-help&quot;)<br /><br /><b>-check</b><br />Checks for newest version info on GitHub<br /> <br /><b>-pwdgen [your password]</b><br />Generates new password hash from plain password, example:<br /><pre class="prettyprint linenums">php skynet.php -pwdgen &quot;foo&quot;</pre><br />It will generate and display hash for password &quot;foo&quot;. <br />Generated hash should be placed in <i>constant PASSWORD</i> in your config file.<br /><br /><b>-keygen</b><br />Generates new SKYNET ID KEY <br />Generated key should be placed in <i>constant KEY_ID</i> in your config file.<br /><br /><b>-compile</b><br />Compiles sources from <i>/src</i> into standalone (by default: source dir is &quot;/src&quot;, example:<br /><pre class="prettyprint linenums">php skynet.php -compile</pre><br />It will compile all files from <i>/src</i> directory into <i>/compiled/123456_skynet.php</i> standalone cluster where <i>123456</i> is actual time in linux format.<br /><a name="13_API_Documentation"></a><h1>13. API Documentation</h1>Full API reference is available with PHPDOC:<br /><br /><a href="../ApiDocumentation/index.html">../ApiDocumentation/index.html</a><a name="14_Updating_Skynet"></a><h1>14. Updating Skynet</h1>Skynet is still in development, so if new versions will be available on GitHub you will should update your clusters with newest version.<br />When you will download an update with new sources you will need to recompile your version of clusters.<br /><br />After download new version just replace old <i>/src/Skynet</i> folder with new one and do not replace your code from <i>/src/SkynetUser</i> directory. At next, just recompile your clusters. <br />Your old config and listeners will be included into new version of Skynet's core.<a name="15_Contact_and_donate"></a><h1>15. Contact and donate</h1><br />Link to GitHub: <a href="https://github.com/szczyglis-dev/php-skynet-remote-framework">https://github.com/szczyglis-dev/php-skynet-remote-framework</a><br />Link to website: <a href="https://skynetframework.blogspot.com">https://skynetframework.blogspot.com</a><br />Email to author: szczyglis@protonmail.com<br />FB:<a href="https://www.facebook.com/Skynet-Framework-441383486200242">https://www.facebook.com/Skynet-Framework-441383486200242</a> <br /><br /><hr>Skynet is Open Source but if you liked Skynet then you can donate project in BTC: 1LK9tDPBuBFXCKUThFWXNvdcdJ4gzx1Diz<br>or via PayPal: <br>Donate Skynet with:<br>BTC: <b>1LK9tDPBuBFXCKUThFWXNvdcdJ4gzx1Diz</b><br/>PayPal: <a target="_blank" href="https://www.paypal.me/szczyglinski"><b>https://www.paypal.me/szczyglinski</b></a><br><br>Enjoy!</div> 
    <div class="clr"></div>
  </div> 
  </div>
  </body>
  </html>